//
// ZeeMouse - written by Larry Bank
//
// The name is a reference to the original version from several years ago
// which I wrote to communicate with the ZeeMote bluetooth game controller.
// The device used a proprietary protocol on top of RFCOMM
// instead of implementing HID as a "normal" joystick would. I soon added
// support for several other "undocumented" bluetooth game controllers which
// did the same thing. A while later, Power-A released their MOGA controller.
// They tried to be sneaky by creating a protocol which required special bytes
// to be transmitted to the device before it would send any information. The
// normal protocols for bluetooth game controllers is to constantly send info
// when a button or stick position changes. Power-A tried to tightly control
// what software was authorized to talk to their game controllers. It obviously
// didn't work as well as they had planned because their follow-on products
// added support for the standard HID protocol.
//
// GTK version started 11/26/2015
//
#define ZEEMOUSE_MAJOR_VERSION 0
#define ZEEMOUSE_MINOR_VERSION 8

#include <sys/types.h>
#include <sys/socket.h>
#include <bluetooth/bluetooth.h>
#include <bluetooth/rfcomm.h>
#include <bluetooth/sdp.h>
#include <bluetooth/hci.h>
#include <bluetooth/hci_lib.h>
#include <string.h>
#include <stdbool.h>
#include <stdint.h>
#include <stdlib.h>
#include <unistd.h>
#include <time.h>
#include <errno.h>
#include <cairo.h>
#include <gtk/gtk.h>
#include <gio/gio.h> // GTK I/O library we'll use for persistent (settings) data
#include <pthread.h>
#include <X11/X.h>
#include <X11/Xlib.h>
// Need to define these to include the keycode values we need
#define XK_LATIN1
#define XK_MISCELLANY
#include <X11/keysymdef.h>

// Arbitrary value that seems reasonable
#define BUFFER_SIZE 256

// MOGA 'unpublished' command codes
#define CMD_FLUSH 65
#define CMD_INIT 67
#define CMD_RESET 68

// The three operating modes
// MOUSE = simulate mouse movement and L/R buttons
// JOYSTICK = generate keypresses for direction and button changes
enum
{
MOUSE_MODE_MOUSE=0,
MOUSE_MODE_JOYSTICK,
MOUSE_MODE_BOTH,
MOUSE_MODE_COUNT
};

//
// The complete "picture" of the current state of buttons is held in a
// 32-bit vector. This allows enough room for 2 sets of directions
// and plenty of buttons. A set bit in the 'ulButtons' variable
// indicates a button is pressed.
//
/* Keyboard bit definitions */
#define RKEY_UP_P1      0x00000001
#define RKEY_DOWN_P1    0x00000002
#define RKEY_LEFT_P1    0x00000004
#define RKEY_RIGHT_P1   0x00000008
#define RKEY_BUTTA_P1   0x00000010
#define RKEY_BUTTB_P1   0x00000020
#define RKEY_BUTTC_P1   0x00000040
#define RKEY_BUTTD_P1   0x00000080
#define RKEY_BUTTE_P1   0x00000100
#define RKEY_BUTTF_P1   0x00000200
#define RKEY_START_P1   0x00000400
#define RKEY_SELECT_P1  0x00000800
#define RKEY_UP2_P1     0x00001000
#define RKEY_DOWN2_P1   0x00002000
#define RKEY_LEFT2_P1   0x00004000
#define RKEY_RIGHT2_P1  0x00008000
#define RKEY_LTRIGGER   0x00010000
#define RKEY_RTRIGGER   0x00020000
#define RKEY_LTRIGGER2  0x00040000
#define RKEY_RTRIGGER2  0x00080000

// MOGA Pro button layout
// Left analog stick - (x = byte 6, y = byte 7), Right analog stick - (x = byte 8, y = byte 9)
// Analog stick buttons (press) left = byte 5, 0x40, right = byte 5, 0x80
// D-Pad = byte 5 (up = 1, down = 2, left = 4, right = 8)
// Select = byte 4, 0x20
// Start = byte 4, 0x10
// Buttons = byte 4 (X = 8, Y = 1, A = 4, B = 2)
// Left Shoulder Upper = byte 4, 0x40, Lower = byte 5, 0x10
// Right Shoulder Upper = byte 4, 0x80, Lower = byte 5, 0x20
//
// Default keys generated for directional changes and button presses
// FUTURE - add a way to load/save different sets of custom key codes
static unsigned int uiDefaultJoyKeys[] = {XK_Up, XK_Down, XK_Left, XK_Right, XK_z, XK_x, XK_c, XK_v, XK_b, XK_n, XK_Return, XK_a};
static uint32_t ulZKeys[] = {RKEY_BUTTA_P1, RKEY_BUTTB_P1, RKEY_SELECT_P1, RKEY_START_P1};
static uint32_t ulMOGAKeys[] = { RKEY_BUTTD_P1, RKEY_BUTTB_P1, RKEY_BUTTA_P1, RKEY_BUTTC_P1, RKEY_START_P1, RKEY_SELECT_P1, RKEY_LTRIGGER, RKEY_RTRIGGER};
static uint32_t ulMOGAKeys2[] = { RKEY_UP_P1, RKEY_DOWN_P1, RKEY_LEFT_P1, RKEY_RIGHT_P1, RKEY_LTRIGGER2, RKEY_RTRIGGER2, RKEY_BUTTE_P1, RKEY_BUTTF_P1};
static uint32_t ulICPKeys[] = {RKEY_UP_P1, RKEY_RIGHT_P1, RKEY_LEFT_P1, RKEY_DOWN_P1, RKEY_BUTTE_P1, // byte A
                        		    RKEY_SELECT_P1, RKEY_START_P1, RKEY_BUTTD_P1, RKEY_BUTTA_P1, RKEY_BUTTC_P1, RKEY_BUTTB_P1, RKEY_BUTTF_P1}; // byte B
static uint32_t ulSteelButtons[] = {RKEY_BUTTD_P1, RKEY_BUTTC_P1, RKEY_BUTTA_P1, RKEY_BUTTB_P1};
static uint32_t ulSteelButtons2[] = {RKEY_UP_P1, RKEY_DOWN_P1, RKEY_LEFT_P1, RKEY_RIGHT_P1, RKEY_BUTTE_P1, RKEY_BUTTF_P1, RKEY_START_P1, RKEY_SELECT_P1};

// X11 variables for controllering the mouse/key input
Display *dpy;
Window root_window;
int iCursorX, iCursorY;
pthread_mutex_t mutex; // needed to keep key/mouse events from colliding

// GTK Settings variables
#define MAX_DEVICES 10
GSettings *mySettings;
int iDeviceCount, iDeviceType, iDevice;
char *szDeviceName[MAX_DEVICES];
char *szDeviceAddr[MAX_DEVICES];
int iDeviceMode[MAX_DEVICES];

// Maximum number of devices to scan
#define MAX_RSP 32
inquiry_info *ii;
bool bConnected = FALSE;
bool bRunning = TRUE;
int iBattery;
uint32_t ulButtons;
// Analog stick positions (signed int range -128 to +127)
int iX, iY, iX2, iY2;
int iMouseMode = MOUSE_MODE_MOUSE; // DEBUG
bool b4Way;

// List of supported device types
// The devices are identified by their bluetooth 'friendly' name
enum
{
DEVICE_ZEEMOTE=0,
DEVICE_STEELSERIES,
DEVICE_MOGA,
DEVICE_MOGA2,
DEVICE_MOGAPRO,
DEVICE_MOGAPRO2, // Moga Pro Power
DEVICE_BGP100,
DEVICE_ICONTROLPAD,
DEVICE_STRATUS,
DEVICE_COUNT
};
char *szDeviceNames[] = {"Zeemote JS1", "Zeemote: SteelSeries FREE", "BD&A", "Moga 2", "Moga Pro", "Moga Pro 2", "GAMEPAD", "iControlPad","SteelSeries Stratus", NULL};
char *szModeNames[] = {"Mouse","Joystick","Mouse+Joystick",NULL};
pthread_t tinfo;

unsigned char STRATUS_INIT[] = { 0xff, 0x55, 0x02, 0x00, 0xee, 0x10 };

const unsigned char STRATUS_HANDSHAKE[] = {
	0xff, 0x5a, 0x00, 0x1a, 0xc0, 0x4b, 0x40, 0x00, 0x42, 0x01, 0x7f, 0xff, 0xff, 0x05, 0xdc, 
	0x00, 0x48, 0x1e, 0x03, 0x0a, 0x00, 0x01, 0x0b, 0x02, 0x01, 0x1f};

unsigned char STRATUS_CONFIGURE[] = {

};

unsigned char STRATUS_HEARTBEAT[] = {

};

// Stick the PNG icon image in main.c to simplify building/distributing
// the executable as a single file. This allows the app to show its icon
// when running without having to "install" it.

unsigned char ucIcon[] = {
		0x89,0x50,0x4e,0x47,0x0d,0x0a,0x1a,0x0a,0x00,0x00,0x00,0x0d,0x49,0x48,0x44,0x52,
	0x00,0x00,0x00,0x80,0x00,0x00,0x00,0x80,0x08,0x06,0x00,0x00,0x00,0xc3,0x3e,0x61,
	0xcb,0x00,0x00,0x00,0x06,0x62,0x4b,0x47,0x44,0x00,0xff,0x00,0xff,0x00,0xff,0xa0,
	0xbd,0xa7,0x93,0x00,0x00,0x00,0x09,0x70,0x48,0x59,0x73,0x00,0x00,0x12,0x74,0x00,
	0x00,0x12,0x74,0x01,0xde,0x66,0x1f,0x78,0x00,0x00,0x00,0x07,0x74,0x49,0x4d,0x45,
	0x07,0xe0,0x03,0x0f,0x0a,0x0b,0x27,0x8e,0x3a,0x32,0xd2,0x00,0x00,0x1e,0x58,0x49,
	0x44,0x41,0x54,0x78,0xda,0xed,0x7d,0x59,0x57,0x1b,0x57,0xd6,0xf6,0x53,0xa5,0x92,
	0x4a,0x23,0x33,0x92,0xd0,0x3c,0x21,0x30,0x8d,0xbd,0x4c,0xc0,0xd8,0x19,0xda,0xbd,
	0xec,0xd5,0x7f,0xa0,0xef,0xfb,0xc7,0xf4,0xdf,0xe9,0xcb,0x5e,0x7d,0x9b,0xb6,0xd3,
	0x76,0x1a,0xdb,0x09,0x44,0x84,0x60,0x1b,0x90,0xd0,0x3c,0x22,0x07,0x0c,0x9a,0xe7,
	0xf7,0x22,0xdf,0x39,0x5f,0xa9,0x28,0x4d,0x0c,0x36,0x24,0x75,0xd6,0xd2,0xb2,0x9d,
	0x94,0x4a,0x67,0xd8,0x67,0xef,0x67,0x3f,0x7b,0x9f,0x7d,0x98,0x4e,0xa7,0xd3,0xc1,
	0x0d,0x68,0xb9,0x5c,0x0e,0xff,0xfe,0xf7,0xbf,0xf1,0xcf,0x7f,0xfe,0x13,0xdf,0x7f,
	0xff,0x3d,0x14,0x0a,0x05,0x9e,0x3c,0x79,0x82,0xbf,0xff,0xfd,0xef,0xf8,0xdb,0xdf,
	0xfe,0x06,0x95,0x4a,0xd5,0xf7,0xfb,0xc2,0x61,0x30,0x0c,0x03,0xb9,0x0d,0xd7,0xd8,
	0x9b,0xd6,0x21,0x86,0x61,0xc0,0x30,0x0c,0x3a,0x9d,0x0e,0xda,0xed,0x36,0x9a,0xcd,
	0x26,0xea,0xf5,0xba,0xbc,0x52,0xd7,0xd4,0xb8,0x1b,0x25,0x8d,0x2c,0x0b,0x96,0x65,
	0xc1,0x30,0x0c,0x5a,0xad,0x16,0x8a,0xc5,0x22,0x72,0xb9,0x1c,0xa2,0xd1,0x28,0x5c,
	0x2e,0x17,0x94,0x4a,0x25,0xaa,0xd5,0x2a,0xaa,0xd5,0x2a,0x58,0x96,0x85,0x4a,0xa5,
	0x82,0x5a,0xad,0x06,0xcf,0xf3,0xf2,0xae,0xbf,0xed,0x02,0xc0,0x30,0x0c,0x14,0x0a,
	0x05,0x54,0x2a,0x15,0x38,0x8e,0x43,0xa5,0x52,0x41,0x3a,0x9d,0xc6,0xf6,0xf6,0x36,
	0x58,0x96,0x85,0xd1,0x68,0x44,0xa7,0xd3,0x41,0xa5,0x52,0x41,0xab,0xd5,0x82,0xc1,
	0x60,0x80,0xdd,0x6e,0x87,0xd7,0xeb,0x85,0xc5,0x62,0xe9,0x69,0x12,0x64,0xc1,0xb8,
	0x45,0x1a,0x80,0xe3,0x38,0x2a,0x00,0x9d,0x4e,0x07,0x89,0x44,0x02,0x2c,0xcb,0x22,
	0x95,0x4a,0x41,0xab,0xd5,0xa2,0x56,0xab,0xa1,0x5c,0x2e,0x83,0x65,0x59,0x58,0x2c,
	0x16,0xac,0xaf,0xaf,0x43,0xab,0xd5,0x4a,0x0a,0x80,0x50,0x10,0x64,0x21,0xb8,0x25,
	0x1a,0x80,0x65,0x59,0x70,0x1c,0x07,0x85,0x42,0x01,0x00,0xa8,0xd5,0x6a,0x38,0x38,
	0x38,0x40,0x32,0x99,0x04,0xc3,0x30,0x28,0x97,0xcb,0x74,0x67,0x3b,0x9d,0x4e,0xe8,
	0xf5,0x7a,0xf8,0xfd,0x7e,0x54,0x2a,0x15,0x68,0x34,0x1a,0x79,0x35,0x6f,0x3b,0x08,
	0x24,0x00,0x50,0xdc,0x88,0xdd,0x17,0x22,0xfd,0x56,0xab,0x85,0xb3,0xb3,0x33,0xa4,
	0xd3,0x69,0x84,0xc3,0x61,0x94,0xcb,0x65,0xc9,0x77,0xc9,0xbb,0xff,0x96,0x68,0x00,
	0x82,0xfa,0x5b,0xad,0x16,0xda,0xed,0x36,0xfd,0xef,0x53,0x53,0x53,0x30,0x99,0x4c,
	0xd0,0x6a,0xb5,0x54,0x3b,0xa8,0x54,0x2a,0x18,0x0c,0x06,0xe8,0x74,0x3a,0xba,0xf8,
	0x16,0x8b,0x05,0x2e,0x97,0x0b,0x2e,0x97,0x0b,0x46,0xa3,0x51,0xc6,0x04,0xb7,0x11,
	0x03,0xb4,0x5a,0x2d,0x34,0x1a,0x0d,0xb4,0x5a,0x2d,0x00,0xc0,0xf4,0xf4,0x34,0x96,
	0x96,0x96,0xb0,0xb8,0xb8,0x08,0x93,0xc9,0x84,0xc9,0xc9,0x49,0xe8,0xf5,0x7a,0x70,
	0x1c,0x87,0x6a,0xb5,0x8a,0x44,0x22,0x81,0x70,0x38,0x8c,0xcd,0xcd,0x4d,0x4c,0x4c,
	0x4c,0x60,0x6d,0x6d,0x0d,0x4f,0x9f,0x3e,0x95,0x14,0x00,0x19,0x13,0xdc,0x02,0x0d,
	0x20,0x14,0x00,0x96,0x65,0x31,0x33,0x33,0x03,0xbf,0xdf,0x8f,0xf5,0xf5,0x75,0x78,
	0x3c,0x1e,0xd8,0x6c,0x36,0x4c,0x4f,0x4f,0x43,0xa1,0x50,0x20,0x93,0xc9,0xe0,0xd9,
	0xb3,0x67,0xf8,0xe9,0xa7,0x9f,0xb0,0xb5,0xb5,0x05,0x8e,0xfb,0x6d,0x28,0x1e,0x8f,
	0x07,0xcb,0xcb,0xcb,0xd0,0x6a,0xb5,0xf2,0xea,0xde,0x36,0x0d,0x40,0xcc,0x40,0xa7,
	0xd3,0x01,0xcb,0xb2,0xd0,0x68,0x34,0x98,0x9c,0x9c,0x84,0xd9,0x6c,0x86,0xdd,0x6e,
	0xa7,0x5c,0x00,0x00,0xa8,0xd5,0x6a,0xcc,0xcd,0xcd,0x61,0x7c,0x7c,0x1c,0x4a,0xa5,
	0x12,0xf5,0x7a,0x1d,0x27,0x27,0x27,0x48,0xa5,0x52,0x38,0x3c,0x3c,0x84,0xd7,0xeb,
	0xed,0x12,0x02,0x79,0xd7,0xdf,0x02,0x01,0x90,0xf2,0x0a,0x14,0x0a,0x05,0x94,0x4a,
	0x25,0x94,0x4a,0x25,0xdd,0xe5,0x44,0x00,0x9c,0x4e,0x27,0xd6,0xd6,0xd6,0xd0,0x6e,
	0xb7,0x71,0x72,0x72,0x02,0x83,0xc1,0x80,0x48,0x24,0x82,0x6f,0xbf,0xfd,0x16,0xef,
	0xdf,0xbf,0x97,0x31,0xc1,0x6d,0x16,0x00,0x21,0x15,0xdc,0x68,0x34,0x50,0xab,0xd5,
	0x50,0x2a,0x95,0xa0,0xd7,0xeb,0xe9,0x33,0x6e,0xb7,0x1b,0x4f,0x9f,0x3e,0x85,0xcb,
	0xe5,0x42,0x2a,0x95,0x42,0x24,0x12,0x41,0x3c,0x1e,0xc7,0xdb,0xb7,0x6f,0x31,0x39,
	0x39,0x29,0x63,0x82,0xdb,0x28,0x00,0xc2,0xc5,0x68,0xb5,0x5a,0x68,0x36,0x9b,0xa8,
	0xd5,0x6a,0xa8,0x56,0xab,0x28,0x14,0x0a,0xd4,0x34,0x30,0x0c,0x83,0xa9,0xa9,0x29,
	0x4c,0x4d,0x4d,0x61,0x69,0x69,0x09,0x87,0x87,0x87,0xf8,0xf6,0xdb,0x6f,0xf1,0xf6,
	0xed,0x5b,0x6c,0x6d,0x6d,0x51,0x53,0x21,0x63,0x82,0x5b,0xc4,0x03,0x48,0xa9,0xe8,
	0x4e,0xa7,0xd3,0xe5,0x22,0x36,0x9b,0x4d,0x34,0x9b,0xcd,0xae,0x67,0xb5,0x5a,0x2d,
	0xbc,0x5e,0x2f,0xac,0x56,0x2b,0x26,0x27,0x27,0xa1,0x54,0x2a,0xd1,0x68,0x34,0xba,
	0x30,0x81,0xcc,0x13,0xdc,0x32,0x13,0x30,0x48,0x30,0xc4,0x4d,0xab,0xd5,0xc2,0xe5,
	0x72,0x61,0x6d,0x6d,0x0d,0x00,0x64,0x4c,0xf0,0x7b,0x15,0x80,0x7e,0x0b,0xe4,0x72,
	0xb9,0xf0,0xf4,0xe9,0x53,0x78,0x3c,0x1e,0x19,0x13,0xfc,0x1e,0x05,0x60,0x90,0xda,
	0x36,0x1a,0x8d,0x30,0x1a,0x8d,0x58,0x5e,0x5e,0x96,0x31,0xc1,0x6d,0xc7,0x00,0x97,
	0x69,0x32,0x26,0xf8,0x1d,0x9b,0x80,0x51,0x84,0x40,0xc6,0x04,0x7f,0x60,0x01,0x90,
	0x31,0x81,0x2c,0x00,0x32,0x26,0xf8,0xa3,0x61,0x00,0xc2,0x19,0x88,0x5d,0x45,0x19,
	0x13,0xfc,0x41,0x35,0x80,0x8c,0x09,0xfe,0x60,0x02,0x40,0xd2,0xc9,0x65,0x4c,0xf0,
	0x07,0xd6,0x00,0xfd,0x16,0x47,0xc6,0x04,0x7f,0x10,0x1e,0x40,0xc6,0x04,0x32,0x06,
	0x90,0x31,0x81,0x2c,0x00,0x32,0x26,0x90,0x35,0x80,0x8c,0x09,0xfe,0xd8,0x18,0x40,
	0xc6,0x04,0xb2,0x06,0x90,0x31,0x81,0x2c,0x00,0x32,0x26,0x90,0x05,0x40,0xc6,0x04,
	0x32,0x06,0x90,0x31,0x81,0xac,0x01,0x64,0x4c,0x20,0x0b,0x80,0x8c,0x09,0x64,0x01,
	0x90,0x31,0x81,0x8c,0x01,0x64,0x4c,0x20,0x6b,0x00,0x19,0x13,0xc8,0x02,0x20,0x63,
	0x02,0x59,0x00,0x64,0x4c,0x20,0x63,0x80,0x8b,0x9a,0x03,0x9f,0xcf,0x07,0xbb,0xdd,
	0x8e,0xa9,0xa9,0x29,0xf0,0x3c,0x8f,0x56,0xab,0x85,0xd3,0xd3,0x53,0x64,0x32,0x19,
	0x44,0x22,0x11,0x54,0x2a,0x95,0x5b,0x81,0x09,0xfe,0xf0,0x1a,0xe0,0xa2,0xb6,0x59,
	0xa3,0xd1,0xe0,0xce,0x9d,0x3b,0x78,0xfc,0xf8,0x31,0xb4,0x5a,0x2d,0x3e,0x7e,0xfc,
	0x88,0xb1,0xb1,0x31,0x1c,0x1d,0x1d,0x61,0x63,0x63,0x03,0xe1,0x70,0x18,0x16,0x8b,
	0x05,0x66,0xb3,0x19,0x33,0x33,0x33,0xe0,0x79,0x5e,0x06,0x81,0x37,0x75,0xf1,0x2f,
	0xda,0x16,0x16,0x16,0xc0,0xf3,0x3c,0x96,0x96,0x96,0x90,0x4a,0xa5,0x10,0x8d,0x46,
	0x91,0x4c,0x26,0x71,0x78,0x78,0x08,0x9d,0x4e,0x87,0xa5,0xa5,0x25,0xac,0xaf,0xaf,
	0x43,0xaf,0xd7,0xcb,0x02,0xf0,0x7b,0x6c,0x1c,0xc7,0xc1,0xe7,0xf3,0xc1,0xe7,0xf3,
	0x21,0x1a,0x8d,0xa2,0x5e,0xaf,0x23,0x10,0x08,0x60,0x6b,0x6b,0x0b,0x0c,0xc3,0xa0,
	0x58,0x2c,0xc2,0x6c,0x36,0x63,0x71,0x71,0x51,0x76,0x03,0x6f,0x3a,0xe0,0x6b,0xb7,
	0xdb,0xb4,0x12,0x49,0xbd,0x5e,0x47,0xab,0xd5,0x3a,0x87,0xd8,0x85,0x1a,0x83,0xe3,
	0x38,0xe8,0xf5,0x7a,0xa8,0xd5,0x6a,0xfa,0xfd,0x52,0xa9,0x84,0x6c,0x36,0x8b,0x44,
	0x22,0x01,0x00,0x70,0x38,0x1c,0x28,0x14,0x0a,0xb4,0xea,0x99,0x2c,0x00,0x37,0xd8,
	0xa6,0x37,0x1a,0x0d,0xe4,0x72,0x39,0xa4,0x52,0x29,0xe4,0x72,0x39,0x14,0x0a,0x05,
	0x34,0x1a,0x8d,0x73,0x85,0x2a,0xc8,0xbb,0x89,0x00,0x90,0x92,0x35,0xa9,0x54,0x0a,
	0x5b,0x5b,0x5b,0x38,0x3c,0x3c,0xa4,0xef,0x14,0x0a,0x92,0x2c,0x00,0x37,0xdc,0xa6,
	0xd7,0x6a,0x35,0xba,0x88,0xbb,0xbb,0xbb,0xc8,0x66,0xb3,0x94,0xdd,0x23,0xfc,0x80,
	0x50,0x00,0x58,0x96,0x05,0xcf,0xf3,0xd4,0xb6,0x9f,0x9e,0x9e,0x62,0x7f,0x7f,0x1f,
	0xf9,0x7c,0x9e,0xbe,0x93,0xe7,0xf9,0xae,0xc2,0x56,0xb2,0x00,0xdc,0xe0,0x56,0xaf,
	0xd7,0x91,0xcb,0xe5,0xb0,0xbb,0xbb,0x8b,0x97,0x2f,0x5f,0x52,0x57,0x8e,0x54,0x26,
	0x15,0x93,0x38,0x62,0xb7,0x8e,0x98,0x0f,0xe1,0xe2,0x4f,0x4c,0x4c,0x40,0xa3,0xd1,
	0x80,0x65,0x59,0x59,0x00,0x3e,0x07,0x89,0x43,0x6a,0x0c,0x93,0x0b,0x27,0xc8,0xfd,
	0x02,0xc4,0x6e,0x0b,0x9b,0xb0,0xf6,0xf0,0xe1,0xe1,0x21,0x5d,0x4c,0x52,0xba,0x96,
	0x10,0x3d,0xc2,0x78,0x01,0xf9,0x08,0x4b,0xda,0xb5,0x5a,0x2d,0x68,0x34,0x1a,0xb8,
	0xdd,0x6e,0x58,0x2c,0x16,0x8c,0x8d,0x8d,0xd1,0xe2,0xd7,0xb2,0x00,0x7c,0xe2,0x96,
	0xcb,0xe5,0x70,0x70,0x70,0x80,0x74,0x3a,0x0d,0x00,0xb0,0x58,0x2c,0xf0,0xfb,0xfd,
	0x70,0x3a,0x9d,0xe7,0x9e,0x6d,0xb7,0xdb,0x28,0x97,0xcb,0x38,0x39,0x39,0xe9,0xda,
	0xc9,0x4e,0xa7,0x13,0x0b,0x0b,0x0b,0x18,0x1f,0x1f,0xa7,0xa6,0xa2,0x56,0xab,0xd1,
	0x82,0x96,0x42,0x6d,0x40,0xfe,0xad,0xd5,0x6a,0x61,0x36,0x9b,0xb1,0xbc,0xbc,0x0c,
	0x93,0xc9,0x34,0xf0,0xba,0x1b,0x59,0x00,0xae,0xa9,0x25,0x12,0x09,0x7c,0xff,0xfd,
	0xf7,0x08,0x04,0x02,0x00,0x80,0x95,0x95,0x15,0x68,0x34,0x1a,0x49,0x01,0xe8,0x74,
	0x3a,0xe7,0xd4,0xf8,0xec,0xec,0x2c,0x1e,0x3f,0x7e,0x8c,0xbf,0xfc,0xe5,0x2f,0xb0,
	0x5a,0xad,0x00,0x80,0x62,0xb1,0x88,0x62,0xb1,0x88,0x66,0xb3,0x79,0x4e,0x00,0xc8,
	0xdf,0x95,0x4a,0x25,0x0c,0x06,0x03,0x4c,0x26,0x13,0xac,0x56,0xeb,0x8d,0xe5,0x00,
	0x7e,0xd7,0x02,0x50,0x2a,0x95,0x90,0x4a,0xa5,0xb0,0xb3,0xb3,0x83,0x8d,0x8d,0x0d,
	0x00,0x80,0x42,0xa1,0xc0,0xd2,0xd2,0x12,0x4a,0xa5,0x12,0x74,0x3a,0xdd,0x39,0xf3,
	0xc1,0x71,0x5c,0xd7,0x62,0x79,0xbd,0x5e,0xac,0xae,0xae,0xe2,0xc9,0x93,0x27,0xf0,
	0x78,0x3c,0xd4,0xac,0x10,0x01,0x90,0x32,0x3d,0xc4,0x24,0x10,0xec,0xc0,0xf3,0x3c,
	0x35,0x1f,0xb2,0x00,0x7c,0xa2,0x56,0x2e,0x97,0x11,0x0e,0x87,0x91,0xc9,0x64,0x50,
	0x2a,0x95,0x68,0xf9,0xf9,0x72,0xb9,0x4c,0xef,0x20,0xf2,0xf9,0x7c,0x5d,0x8b,0xad,
	0x54,0x2a,0x31,0x31,0x31,0x01,0xab,0xd5,0x0a,0x87,0xc3,0x81,0x4e,0xa7,0x83,0xb9,
	0xb9,0x39,0xe8,0xf5,0xfa,0x2e,0x1b,0xde,0x0b,0x43,0x8c,0xe2,0xa1,0xc8,0xd1,0xc0,
	0x4b,0xb8,0x79,0x52,0x09,0x1b,0xa4,0x1d,0x1d,0x1d,0x21,0x1a,0x8d,0x22,0x1a,0x8d,
	0x22,0x95,0x4a,0x21,0x91,0x48,0x60,0x6a,0x6a,0x0a,0xeb,0xeb,0xeb,0xb4,0xfa,0x38,
	0xe1,0xea,0xc9,0x45,0x54,0x76,0xbb,0x1d,0x63,0x63,0x63,0xd0,0x6a,0xb5,0x70,0xbb,
	0xdd,0x78,0xf4,0xe8,0x11,0x74,0x3a,0x1d,0xca,0xe5,0x32,0xa6,0xa6,0xa6,0x70,0x7c,
	0x7c,0x8c,0xcd,0xcd,0x4d,0xa4,0xd3,0x69,0xcc,0xcd,0xcd,0xc1,0x6c,0x36,0x5f,0x48,
	0x00,0x64,0x0d,0xf0,0x09,0x7c,0xfd,0x68,0x34,0x8a,0x67,0xcf,0x9e,0x61,0x73,0x73,
	0x13,0x1f,0x3f,0x7e,0xc4,0xcc,0xcc,0x0c,0xbc,0x5e,0x2f,0x6c,0x36,0x1b,0x14,0x0a,
	0x05,0x8e,0x8e,0x8e,0x90,0x4c,0x26,0x11,0x0c,0x06,0x31,0x36,0x36,0x86,0xbb,0x77,
	0xef,0xe2,0xd1,0xa3,0x47,0x34,0x7c,0x7b,0xe7,0xce,0x1d,0xe8,0x74,0x3a,0xf8,0x7c,
	0x3e,0xe4,0x72,0x39,0xa4,0xd3,0x69,0xc4,0x62,0x31,0xbc,0x7b,0xf7,0x0e,0x63,0x63,
	0x63,0x94,0xdb,0xbf,0x77,0xef,0xde,0x85,0x91,0xbd,0x1c,0x0d,0xbc,0x62,0x57,0x4f,
	0xa8,0xf6,0xa3,0xd1,0x28,0x36,0x37,0x37,0xf1,0xdf,0xff,0xfe,0x17,0xad,0x56,0x0b,
	0xdf,0x7c,0xf3,0x0d,0xe6,0xe7,0xe7,0xf1,0xf8,0xf1,0x63,0xb0,0x2c,0x8b,0x8d,0x8d,
	0x0d,0xec,0xee,0xee,0xe2,0xd5,0xab,0x57,0x60,0x59,0x16,0xc5,0x62,0x11,0x46,0xa3,
	0x11,0x1e,0x8f,0x07,0x5a,0xad,0x16,0xe3,0xe3,0xe3,0xb8,0x7b,0xf7,0x2e,0xe6,0xe7,
	0xe7,0x11,0x0e,0x87,0xf1,0xdd,0x77,0xdf,0x61,0x73,0x73,0x13,0xdb,0xdb,0xdb,0x54,
	0x80,0xc6,0xc7,0xc7,0xe1,0x70,0x38,0x30,0x3d,0x3d,0x7d,0xab,0x17,0xfe,0xc6,0x0b,
	0x80,0x98,0x70,0x21,0x7e,0x36,0xc7,0x71,0xe7,0xd8,0xb5,0x72,0xb9,0x8c,0xc3,0xc3,
	0x43,0xa4,0x52,0x29,0x9c,0x9c,0x9c,0xa0,0xd1,0x68,0x80,0xe7,0x79,0x4c,0x4e,0x4e,
	0xc2,0xe1,0x70,0xc0,0xe3,0xf1,0xa0,0xd3,0xe9,0x60,0x67,0x67,0x07,0xc5,0x62,0x91,
	0x72,0xf5,0x36,0x9b,0x0d,0x27,0x27,0x27,0xe7,0xb8,0x7a,0xb5,0x5a,0x0d,0xbb,0xdd,
	0x0e,0xad,0x56,0x8b,0xb3,0xb3,0x33,0xc4,0xe3,0x71,0xea,0x46,0x7e,0xfc,0xf8,0xf1,
	0x5c,0xad,0x62,0xd9,0x04,0x5c,0x93,0x8a,0x27,0x0b,0xce,0xf3,0x3c,0xd4,0x6a,0x35,
	0x0c,0x06,0x43,0x57,0xa6,0xcd,0xf1,0xf1,0x31,0xc2,0xe1,0x30,0xc2,0xe1,0x30,0x4d,
	0xd1,0x32,0x18,0x0c,0x58,0x5d,0x5d,0xc5,0xf4,0xf4,0x34,0x1e,0x3c,0x78,0x00,0xb7,
	0xdb,0x4d,0x05,0xa9,0x5e,0xaf,0xa3,0x50,0x28,0xd0,0xef,0x93,0xa4,0x0d,0x29,0x37,
	0x4d,0xa9,0x54,0xa2,0xd5,0x6a,0x75,0x25,0x7b,0x56,0xab,0x55,0x2a,0x20,0xbd,0xfa,
	0x2d,0x1f,0x0c,0xb9,0x42,0x0d,0x40,0xae,0x91,0x53,0x2a,0x95,0xe0,0x79,0xfe,0x9c,
	0xeb,0x16,0x89,0x44,0xf0,0xec,0xd9,0x33,0xfc,0xf0,0xc3,0x0f,0x34,0x49,0xd3,0xe1,
	0x70,0xc0,0xed,0x76,0xc3,0x6e,0xb7,0x63,0x69,0x69,0x89,0xfa,0xfc,0xe5,0x72,0x19,
	0xc5,0x62,0xb1,0xcb,0xcf,0x27,0xf7,0x14,0x4a,0x2d,0x28,0x61,0x10,0x85,0xbb,0x5d,
	0xe8,0xda,0xf5,0x13,0x60,0xf9,0x6c,0xe0,0x15,0x69,0x02,0x52,0x22,0xbe,0xd1,0x68,
	0xa0,0xd1,0x68,0xa0,0xd9,0x6c,0x52,0x9f,0xba,0x5a,0xad,0x22,0x16,0x8b,0x61,0x73,
	0x73,0x13,0x2f,0x5e,0xbc,0x40,0xbd,0x5e,0xc7,0xea,0xea,0x2a,0xdc,0x6e,0x37,0xfe,
	0xfa,0xd7,0xbf,0xc2,0xe7,0xf3,0x75,0xdd,0x25,0x58,0x2c,0x16,0x51,0xaf,0xd7,0xbb,
	0x7c,0x72,0xad,0x56,0x0b,0x85,0x42,0x81,0x46,0xa3,0x71,0x4e,0x08,0x88,0xa0,0x08,
	0xdf,0xa1,0xd5,0x6a,0xc1,0xb2,0xac,0xe4,0xf3,0xb2,0x09,0xb8,0xa2,0x5d,0x4f,0x28,
	0xd5,0x66,0xb3,0x89,0x72,0xb9,0x8c,0xe3,0xe3,0x63,0x64,0xb3,0x59,0x68,0xb5,0x5a,
	0x74,0x3a,0x9d,0xae,0x4b,0xa3,0x32,0x99,0x0c,0x4e,0x4f,0x4f,0xd1,0x68,0x34,0xa0,
	0x54,0x2a,0x31,0x39,0x39,0x09,0xab,0xd5,0x0a,0xaf,0xd7,0x2b,0x79,0x91,0xa4,0x4e,
	0xa7,0x83,0xc5,0x62,0x81,0xd3,0xe9,0xa4,0xd7,0xcf,0x96,0x4a,0x25,0x24,0x12,0x09,
	0x78,0x3c,0x9e,0xae,0x45,0x55,0x28,0x14,0x98,0x98,0x98,0x80,0xdd,0x6e,0x97,0x7c,
	0xde,0xed,0x76,0x77,0xfd,0xc6,0x6d,0xad,0x13,0xa0,0xf8,0xc7,0x3f,0xfe,0xf1,0x8f,
	0x9b,0xc2,0xdc,0x1d,0x1c,0x1c,0xe0,0xed,0xdb,0xb7,0x08,0x85,0x42,0x68,0xb7,0xdb,
	0xf4,0x92,0xe8,0x46,0xa3,0x81,0x0f,0x1f,0x3e,0x20,0x99,0x4c,0x22,0x14,0x0a,0x61,
	0x7f,0x7f,0x1f,0xa1,0x50,0x08,0xc9,0x64,0x12,0x95,0x4a,0x05,0x13,0x13,0x13,0x58,
	0x5c,0x5c,0xc4,0xda,0xda,0x1a,0x56,0x56,0x56,0xe0,0x72,0xb9,0xce,0xbd,0x9f,0x08,
	0x14,0x00,0x4a,0xd3,0x4e,0x4d,0x4d,0x41,0xa1,0x50,0xe0,0xec,0xec,0x0c,0x47,0x47,
	0x47,0xa8,0xd5,0x6a,0x5d,0x44,0x4f,0xa3,0xd1,0x00,0x00,0xe8,0xf5,0x7a,0xc9,0xe7,
	0x0b,0x85,0x02,0x3a,0x9d,0xce,0xad,0x08,0xfb,0xde,0x2a,0x10,0x48,0xec,0x6e,0xa9,
	0x54,0xc2,0x2f,0xbf,0xfc,0x42,0xed,0x3b,0xb9,0x38,0x92,0x70,0xed,0xd3,0xd3,0xd3,
	0x70,0xbb,0xdd,0xf8,0xf2,0xcb,0x2f,0xbb,0x2e,0x8e,0x94,0x6a,0x6a,0xb5,0x1a,0x5e,
	0xaf,0x17,0x3a,0x9d,0x0e,0x0b,0x0b,0x0b,0xc8,0xe5,0x72,0x48,0x24,0x12,0x48,0xa5,
	0x52,0xd8,0xdb,0xdb,0x83,0xc1,0x60,0xa0,0xbc,0xc0,0xdd,0xbb,0x77,0xa1,0xd5,0x6a,
	0xb1,0xb8,0xb8,0x48,0x4f,0x05,0x91,0x4c,0x1f,0xf2,0xbc,0x5e,0xaf,0xbf,0x15,0x39,
	0x7f,0xb7,0x4a,0x00,0x94,0x4a,0x25,0xdd,0x81,0x04,0xa1,0x97,0x4a,0x25,0xec,0xef,
	0xef,0x83,0xe3,0xb8,0x2e,0x40,0x66,0xb3,0xd9,0xf0,0xe5,0x97,0x5f,0xc2,0xe3,0xf1,
	0xe0,0xeb,0xaf,0xbf,0x86,0xdb,0xed,0xee,0x9b,0x8b,0xcf,0xf3,0x3c,0x6c,0x36,0x1b,
	0x6c,0x36,0x1b,0x2a,0x95,0x0a,0x22,0x91,0x08,0x9e,0x3f,0x7f,0x8e,0x40,0x20,0x80,
	0x40,0x20,0x00,0x85,0x42,0x81,0x52,0xa9,0x04,0xa3,0xd1,0x48,0xaf,0x9c,0x13,0xf3,
	0x02,0x52,0xcf,0xcf,0xcd,0xcd,0xdd,0xe8,0x9c,0xbf,0x5b,0x23,0x00,0x4a,0xa5,0x12,
	0x63,0x63,0x63,0xb0,0x58,0x2c,0xf0,0x78,0x3c,0x88,0x46,0xa3,0xa8,0x56,0xab,0x14,
	0xa9,0x77,0x3a,0x1d,0x94,0x4a,0x25,0xea,0x6e,0x29,0x95,0x4a,0x8c,0x8f,0x8f,0xc3,
	0x66,0xb3,0x9d,0xe3,0xf5,0x07,0x35,0x12,0x11,0x24,0x36,0x3d,0x99,0x4c,0x02,0x00,
	0xec,0x76,0x3b,0x4e,0x4f,0x4f,0x25,0x79,0x81,0x5e,0xcf,0x9f,0x9d,0x9d,0x75,0x5d,
	0x75,0x2b,0x0b,0xc0,0x05,0xdb,0xf8,0xf8,0x38,0xdc,0x6e,0x37,0x1e,0x3c,0x78,0x00,
	0x8d,0x46,0x83,0x6c,0x36,0x8b,0x6a,0xb5,0x4a,0x23,0x6b,0xad,0x56,0x0b,0x95,0x4a,
	0x05,0xb5,0x5a,0x0d,0x1c,0xc7,0xc1,0x6a,0xb5,0x62,0x6d,0x6d,0x0d,0x1e,0x8f,0xe7,
	0x42,0xea,0x57,0xa7,0xd3,0x9d,0x43,0xf2,0xe4,0xc6,0x52,0xa9,0xf7,0x49,0x3d,0xdf,
	0x6e,0xb7,0xa1,0x50,0x28,0x6e,0xb5,0x47,0x70,0x63,0x04,0x40,0xa1,0x50,0xc0,0xeb,
	0xf5,0x52,0x5b,0x5d,0x2c,0x16,0x29,0x08,0x23,0x9e,0x01,0x71,0x05,0x59,0x96,0xc5,
	0xf8,0xf8,0x38,0xbd,0x4d,0xf4,0xa2,0x8d,0x65,0xd9,0x2e,0xb7,0x90,0x98,0x9f,0x5e,
	0x0b,0x3a,0xea,0xf3,0xb2,0x00,0x5c,0x60,0x57,0xfa,0x7c,0x3e,0xea,0x76,0x89,0x03,
	0x3f,0xc2,0x14,0x2c,0x85,0x42,0x01,0x9e,0xe7,0x2f,0x9c,0x6f,0x57,0x2a,0x95,0x50,
	0xab,0xd5,0xc0,0x30,0x0c,0x5d,0x40,0x95,0x4a,0x05,0x86,0x61,0x24,0xa9,0x5e,0xa9,
	0xe7,0x89,0x30,0x10,0xea,0xf9,0x56,0x0a,0x80,0x30,0x8b,0x55,0x8a,0xda,0xbc,0xce,
	0x94,0x66,0xe1,0xbb,0x85,0x5c,0xbf,0x42,0xa1,0x00,0xcb,0xb2,0xd4,0xb7,0x26,0xcf,
	0x09,0x17,0xbb,0xd5,0x6a,0xd1,0xc4,0x8c,0x76,0xbb,0xdd,0x95,0xa2,0xd5,0x8b,0x63,
	0xd0,0x68,0x34,0xe0,0x79,0x1e,0xf5,0x7a,0x1d,0xd1,0x68,0x14,0xb9,0x5c,0x0e,0xe5,
	0x72,0x99,0x7e,0xaf,0x52,0xa9,0x20,0x9f,0xcf,0x23,0x1a,0x8d,0xd2,0x00,0x11,0x61,
	0x11,0x23,0x91,0x08,0x72,0xb9,0x1c,0x05,0xa7,0x0c,0xc3,0xa0,0x56,0xab,0xe1,0xd7,
	0x5f,0x7f,0x45,0x2c,0x16,0x83,0xdb,0xed,0x86,0x4a,0xa5,0x42,0xad,0x56,0x43,0xa5,
	0x52,0x19,0x79,0xde,0x3e,0xc5,0x7c,0x0b,0xf9,0x0a,0xf2,0x27,0xf7,0x9f,0xff,0xfc,
	0xe7,0xdc,0x03,0x64,0xa7,0xb5,0x5a,0x2d,0xfa,0x11,0x02,0x9d,0xab,0x22,0x3d,0xc4,
	0x49,0x95,0x4a,0xa5,0x12,0x2a,0x95,0x0a,0x4a,0xa5,0x92,0x0a,0x80,0x38,0x1d,0x5b,
	0xcc,0x14,0x0a,0x3f,0xcd,0x66,0x93,0xf6,0x55,0xdc,0x5f,0x86,0x61,0xe8,0xbb,0x9b,
	0xcd,0x26,0xb2,0xd9,0x2c,0x02,0x81,0x00,0x92,0xc9,0x24,0x65,0xfd,0x92,0xc9,0x24,
	0x7e,0xfa,0xe9,0x27,0x9a,0x0c,0x42,0xc8,0x27,0x92,0x48,0xb2,0xb3,0xb3,0x83,0x7c,
	0x3e,0x4f,0xb1,0xc2,0xf1,0xf1,0x31,0xde,0xbf,0x7f,0x0f,0x8d,0x46,0x83,0x60,0x30,
	0x08,0x8e,0xe3,0xd0,0x68,0x34,0x50,0xaf,0xd7,0x87,0x5e,0xc8,0xeb,0x9c,0x6f,0xa9,
	0x0d,0x46,0x3e,0x64,0x4e,0xb8,0x7f,0xfd,0xeb,0x5f,0x92,0x4c,0x1c,0x39,0x29,0x53,
	0xaf,0xd7,0xd1,0x68,0x34,0xe8,0x0e,0xbb,0x2e,0xc6,0x8b,0xa8,0x75,0xa2,0x01,0xc4,
	0x89,0x96,0xe2,0x01,0x91,0xe7,0xc9,0xb3,0x04,0x23,0xf4,0xea,0xaf,0xf0,0xf9,0x76,
	0xbb,0x8d,0x42,0xa1,0x80,0x74,0x3a,0x4d,0x23,0x83,0xc0,0x6f,0x39,0x84,0x0c,0xc3,
	0x20,0x1e,0x8f,0xc3,0x60,0x30,0x40,0xa9,0x54,0xd2,0xf7,0x96,0xcb,0x65,0xe4,0xf3,
	0x79,0x64,0xb3,0x59,0x6a,0x9e,0xf2,0xf9,0x3c,0x7e,0xfe,0xf9,0x67,0x1c,0x1d,0x1d,
	0xd1,0xcc,0x21,0xb2,0x80,0xc3,0x08,0xc0,0xa7,0x98,0xef,0x41,0x1b,0x8c,0x99,0x9d,
	0x9d,0xed,0x48,0x49,0x9a,0xf0,0xaa,0x56,0x32,0xa0,0xeb,0x0e,0x74,0x88,0xd5,0xd3,
	0xb0,0x26,0x83,0x98,0x06,0xe1,0xd5,0xb2,0x52,0xfd,0x15,0x4e,0x78,0xab,0xd5,0x92,
	0xdc,0xa9,0x44,0x53,0x10,0xc1,0x12,0xc7,0x25,0xc8,0xee,0x24,0xcf,0xf1,0x3c,0x0f,
	0x95,0x4a,0xd5,0xa5,0xb1,0x86,0x55,0xe5,0x9f,0x62,0xbe,0xc9,0x3b,0xc4,0x1b,0x8c,
	0xcc,0x19,0x03,0xa0,0x33,0x0c,0x52,0x16,0xee,0x34,0xb1,0x4a,0xbe,0xac,0x8a,0x1a,
	0x65,0xb7,0x90,0xdf,0x6a,0xb5,0x5a,0x34,0x3d,0x5b,0xdc,0x5f,0x9e,0xe7,0x25,0xfb,
	0x2b,0x75,0xbc,0x8b,0x4c,0x88,0x94,0x00,0x89,0xd5,0xb4,0x50,0x08,0xae,0xcb,0x56,
	0xf7,0x9b,0xef,0x51,0x37,0x90,0x94,0xc0,0x8b,0x39,0x8e,0xbe,0x5e,0x80,0x5e,0xaf,
	0x87,0xd5,0x6a,0x85,0xc9,0x64,0x82,0x5e,0xaf,0x07,0xc3,0x30,0x74,0x12,0x88,0xeb,
	0xd6,0x4f,0x65,0x0f,0x63,0xf3,0x84,0x12,0x3f,0x68,0x62,0xc8,0x6e,0x03,0x40,0x13,
	0x3b,0xc2,0xe1,0x30,0x05,0x66,0x6a,0xb5,0x1a,0x1e,0x8f,0x07,0x0e,0x87,0x03,0x63,
	0x63,0x63,0x60,0x59,0x96,0x62,0x03,0xf2,0x27,0xf9,0x3b,0x49,0xdf,0x16,0xf2,0xf8,
	0xcd,0x66,0x13,0xf5,0x7a,0x1d,0xf5,0x7a,0x1d,0xed,0x76,0x9b,0x6a,0x99,0x4e,0xa7,
	0x83,0x4a,0xa5,0x82,0xe3,0xe3,0x63,0xe4,0xf3,0x79,0x1c,0x1f,0x1f,0x77,0x85,0x95,
	0xaf,0xaa,0x89,0xe7,0x9b,0x65,0xd9,0xa1,0x05,0x4e,0x6a,0x87,0x13,0xed,0xd8,0x6e,
	0xb7,0xe9,0xa1,0x97,0x78,0x3c,0x8e,0x8f,0x1f,0x3f,0x0e,0x16,0x00,0x85,0x42,0x01,
	0x8f,0xc7,0x83,0xb5,0xb5,0x35,0x2c,0x2f,0x2f,0x63,0x76,0x76,0xb6,0x0b,0xe4,0x90,
	0x09,0xec,0x07,0xda,0x2e,0x6a,0xf3,0x84,0xaa,0x57,0xe8,0xf6,0xe9,0xf5,0x7a,0xe8,
	0x74,0x3a,0x30,0x0c,0x83,0x6c,0x36,0x8b,0x37,0x6f,0xde,0xa0,0xd5,0x6a,0x61,0x6f,
	0x6f,0x0f,0xc0,0x6f,0x87,0x38,0xbe,0xf9,0xe6,0x1b,0x3c,0x7c,0xf8,0x10,0x16,0x8b,
	0x05,0x2a,0x95,0x0a,0x8d,0x46,0x03,0xd5,0x6a,0x95,0xee,0x00,0x12,0xe3,0xef,0x74,
	0x3a,0x5d,0x13,0x46,0xd4,0xb0,0x50,0x20,0x85,0xa0,0xf1,0xc3,0x87,0x0f,0x78,0xff,
	0xfe,0x3d,0x7e,0xfe,0xf9,0x67,0xea,0x12,0x5e,0x35,0x0f,0x22,0x9c,0x6f,0xa3,0xd1,
	0x38,0x10,0x54,0xf6,0x03,0xd1,0x84,0xa0,0x52,0x2a,0x95,0xa8,0xd7,0xeb,0x14,0xf4,
	0xbe,0x7a,0xf5,0x0a,0x81,0x40,0x80,0xba,0xba,0xdc,0x30,0xcc,0xdc,0x9f,0xff,0xfc,
	0x67,0x38,0x9d,0x4e,0x28,0x95,0x4a,0xd4,0x6a,0x35,0x9a,0x19,0x23,0x65,0x53,0xfa,
	0xa9,0xf4,0x7e,0x36,0x4f,0x0a,0xf5,0xf6,0x3b,0x8e,0x4d,0xce,0xee,0x05,0x83,0x41,
	0x44,0x22,0x11,0x00,0xbf,0xa5,0x6c,0xdd,0xbb,0x77,0x0f,0x4f,0x9e,0x3c,0xa1,0x99,
	0x40,0xc4,0xbd,0x23,0x3b,0x49,0xf8,0x7b,0xe2,0x03,0x1d,0x42,0x53,0x21,0x76,0x1b,
	0x63,0xb1,0x18,0x34,0x1a,0x0d,0x8e,0x8e,0x8e,0xba,0x4e,0x00,0x5f,0x07,0x13,0x4a,
	0xe6,0x7b,0x90,0x5b,0xd9,0xcf,0x8d,0x56,0x28,0x14,0x5d,0xe1,0xea,0x68,0x34,0x0a,
	0xe0,0xb7,0x53,0xcc,0xe1,0x70,0x18,0xbf,0xfe,0xfa,0x6b,0x7f,0x01,0xe0,0x38,0x0e,
	0x06,0x83,0x01,0x66,0xb3,0xb9,0x2b,0xd0,0xc2,0xf3,0x3c,0xc6,0xc6,0xc6,0xba,0x3a,
	0x21,0x3e,0x4f,0x2f,0x45,0xce,0x88,0x53,0xba,0x49,0x07,0x2f,0x73,0x6e,0x4e,0xcc,
	0x0f,0xb0,0x2c,0xdb,0xc5,0x1f,0x88,0x63,0x0d,0x24,0xa1,0x63,0xd4,0xa6,0x52,0xa9,
	0xe0,0x76,0xbb,0x71,0x70,0x70,0x40,0x35,0xd0,0x75,0x30,0xa1,0x64,0xbe,0x3d,0x1e,
	0x0f,0x5d,0x3c,0x95,0x4a,0x05,0x83,0xc1,0x30,0xf4,0x7b,0x88,0x66,0x95,0xc2,0x46,
	0xc2,0xcf,0x40,0x13,0x20,0x4c,0xc4,0xec,0x75,0xb2,0xa5,0xd9,0x6c,0x22,0x16,0x8b,
	0x21,0x9d,0x4e,0xd3,0x42,0x08,0x44,0x0a,0xc5,0x93,0xd4,0x6e,0xb7,0x69,0xf1,0x05,
	0xc2,0xfa,0x91,0xe4,0x8c,0x89,0x89,0x89,0xa1,0x07,0x98,0xcf,0xe7,0x11,0x8b,0xc5,
	0xb0,0xbf,0xbf,0x8f,0x77,0xef,0xde,0xe1,0xc3,0x87,0x0f,0x68,0xb5,0x5a,0x60,0x18,
	0x06,0x1f,0x3f,0x7e,0x44,0x30,0x18,0xc4,0xf4,0xf4,0x34,0x75,0xe9,0xaa,0xd5,0x2a,
	0x9a,0xcd,0x26,0xb4,0x5a,0x2d,0x4c,0x26,0x13,0x2c,0x16,0xcb,0x48,0x13,0x2a,0x14,
	0x20,0x86,0x61,0xd0,0x68,0x34,0xce,0x15,0x80,0xea,0xa5,0xb5,0xfa,0x69,0x41,0xf1,
	0x73,0xd5,0x6a,0x15,0x9d,0x4e,0x07,0x6a,0xb5,0x5a,0x32,0x99,0x65,0x98,0x56,0x2c,
	0x16,0x69,0x7d,0x83,0x72,0xb9,0x0c,0x8e,0xe3,0xa0,0x56,0xab,0xd1,0xe9,0x74,0x90,
	0xcd,0x66,0xb1,0xb7,0xb7,0x87,0x7c,0x3e,0x4f,0x29,0xf6,0xbe,0x02,0x40,0x40,0x1a,
	0x39,0x2f,0x27,0x25,0x04,0x89,0x44,0x02,0xaf,0x5f,0xbf,0x46,0x20,0x10,0x40,0x26,
	0x93,0xa1,0x29,0x5b,0x3c,0xcf,0x77,0xa1,0x76,0xf2,0xae,0x62,0xb1,0x48,0x23,0x7a,
	0x46,0xa3,0x11,0xf7,0xef,0xdf,0xc7,0x57,0x5f,0x7d,0x85,0x95,0x95,0x95,0xa1,0x8e,
	0x4f,0x25,0x12,0x09,0xfc,0xf0,0xc3,0x0f,0xd8,0xdc,0xdc,0xc4,0xfe,0xfe,0x3e,0x4d,
	0x06,0x25,0xf1,0x81,0x6c,0x36,0x8b,0xcd,0xcd,0x4d,0xe4,0x72,0x39,0x18,0x0c,0x06,
	0x34,0x9b,0x4d,0x6a,0xab,0x67,0x67,0x67,0xf1,0xa7,0x3f,0xfd,0x09,0xab,0xab,0xab,
	0x58,0x5e,0x5e,0x1e,0x39,0x81,0x83,0x9c,0x34,0x26,0x9f,0x41,0x20,0x77,0x90,0x09,
	0x14,0xb7,0x5a,0xad,0x86,0x46,0xa3,0x71,0xe1,0x6a,0x22,0xad,0x56,0x0b,0xe1,0x70,
	0x18,0x9b,0x9b,0x9b,0xd8,0xdd,0xdd,0xa5,0x75,0x0a,0x08,0xc8,0x2d,0x16,0x8b,0x14,
	0x04,0x0a,0xfb,0x3f,0x50,0x00,0xea,0xf5,0x3a,0xaa,0xd5,0x2a,0xad,0x84,0x41,0x5a,
	0xbd,0x5e,0x47,0x30,0x18,0xc4,0x9b,0x37,0x6f,0xf0,0xfc,0xf9,0x73,0x44,0x22,0x11,
	0xd4,0xeb,0x75,0xf0,0x3c,0x4f,0xcf,0xc4,0x0b,0x07,0xdc,0x6c,0x36,0x51,0x2c,0x16,
	0xe9,0x8f,0x93,0x64,0x4d,0x9b,0xcd,0x06,0xaf,0xd7,0x3b,0x30,0xcf,0xbe,0x5e,0xaf,
	0x63,0x6f,0x6f,0x0f,0x2f,0x5e,0xbc,0xc0,0xf3,0xe7,0xcf,0x11,0x0a,0x85,0xba,0x76,
	0x22,0x21,0x66,0x0a,0x85,0x02,0xf6,0xf6,0xf6,0xc0,0xb2,0x2c,0x5d,0x2c,0xa5,0x52,
	0x09,0xa7,0xd3,0x89,0x72,0xb9,0x8c,0xe9,0xe9,0x69,0x38,0x1c,0x0e,0x4c,0x4d,0x4d,
	0x8d,0x2c,0x00,0x44,0xd0,0x54,0x2a,0xd5,0x95,0xa7,0x86,0x13,0xd2,0xa9,0x5a,0xad,
	0xa2,0x52,0xa9,0x8c,0xac,0x05,0x4e,0x4f,0x4f,0x11,0x89,0x44,0xf0,0xe3,0x8f,0x3f,
	0xe2,0xe5,0xcb,0x97,0x88,0xc5,0x62,0x34,0x77,0x51,0xad,0x56,0xa3,0xdd,0x6e,0xa3,
	0x5e,0xaf,0x77,0x69,0xe1,0x81,0x26,0xa0,0x57,0x5d,0x3b,0xb2,0xf8,0x07,0x07,0x07,
	0x08,0x06,0x83,0x08,0x85,0x42,0x74,0x61,0x1b,0x8d,0x06,0x8a,0xc5,0xe2,0x48,0x7e,
	0xeb,0x20,0xb5,0x59,0xad,0x56,0x71,0x78,0x78,0x88,0xfd,0xfd,0x7d,0xec,0xef,0xef,
	0x23,0x18,0x0c,0x9e,0xdb,0x85,0x04,0x8b,0x08,0x07,0x27,0xdc,0x5d,0x91,0x48,0x04,
	0x7e,0xbf,0x1f,0xa5,0x52,0xa9,0x6b,0x97,0x35,0x9b,0x4d,0x9c,0x9e,0x9e,0xd2,0x1a,
	0x00,0x6a,0xb5,0x9a,0x12,0x3b,0x62,0x1b,0xaa,0xd7,0xeb,0x61,0x36,0x9b,0xe1,0x72,
	0xb9,0x10,0x0e,0x87,0xbb,0xfa,0x30,0x8c,0xaf,0xde,0xeb,0x19,0x8d,0x46,0x43,0xcf,
	0x21,0x14,0x8b,0x45,0xc4,0x62,0x31,0x38,0x9d,0xce,0x91,0x84,0xa0,0xd9,0x6c,0xa2,
	0x50,0x28,0x20,0x9b,0xcd,0x22,0x12,0x89,0xd0,0xf4,0xb7,0x5a,0xad,0x86,0xd3,0xd3,
	0xd3,0x9e,0x73,0xcf,0x0d,0x02,0x26,0xc4,0xa5,0x20,0x3f,0x92,0x48,0x24,0xe8,0xe2,
	0x6f,0x6d,0x6d,0x9d,0x53,0x29,0x7d,0x23,0x4f,0x1c,0x87,0xd9,0xd9,0x59,0x9a,0xc4,
	0xb1,0xbc,0xbc,0x0c,0xb3,0xd9,0x2c,0xa9,0xfe,0xeb,0xf5,0x3a,0x3e,0x7e,0xfc,0x48,
	0x8f,0x73,0x85,0x42,0x21,0x6c,0x6e,0x6e,0x22,0x16,0x8b,0x0d,0xfd,0x7b,0xc2,0x46,
	0xea,0xfd,0x08,0x3d,0x96,0xb3,0xb3,0x33,0x1c,0x1c,0x1c,0x20,0x16,0x8b,0xa1,0xdd,
	0x6e,0x63,0x76,0x76,0x16,0x0e,0x87,0x03,0x16,0x8b,0xe5,0x5c,0x88,0x57,0xa5,0x52,
	0xc1,0x62,0xb1,0xe0,0xfe,0xfd,0xfb,0x60,0x59,0x16,0x4e,0xa7,0x13,0xc9,0x64,0x12,
	0x47,0x47,0x47,0x38,0x39,0x39,0x91,0x14,0xbc,0x7e,0x8d,0xe7,0x79,0xcc,0xcc,0xcc,
	0x60,0x6e,0x6e,0x0e,0x73,0x73,0x73,0x98,0x9d,0x9d,0xc5,0xcc,0xcc,0x0c,0x72,0xb9,
	0x1c,0x36,0x36,0x36,0x10,0x0c,0x06,0xe9,0xff,0x1b,0xa6,0xce,0xa0,0x90,0x57,0x19,
	0xa5,0x2f,0xdc,0x20,0x62,0x41,0xa5,0x52,0x81,0xe3,0x38,0x74,0x3a,0x1d,0xc4,0x62,
	0x31,0xbc,0x7e,0xfd,0x1a,0x6f,0xde,0xbc,0x41,0x30,0x18,0x44,0x3c,0x1e,0xa7,0xc5,
	0x17,0x86,0x61,0xb8,0xfc,0x7e,0x3f,0x56,0x56,0x56,0x70,0xef,0xde,0x3d,0x78,0xbd,
	0xde,0x9e,0x93,0x4d,0x24,0x37,0x16,0x8b,0x21,0x10,0x08,0x60,0x67,0x67,0x07,0x87,
	0x87,0x87,0x88,0xc5,0x62,0xc8,0x64,0x32,0x17,0x52,0xb1,0xe4,0x70,0x09,0xf1,0x8d,
	0xdb,0xed,0x36,0xa2,0xd1,0x28,0x36,0x36,0x36,0x10,0x08,0x04,0xd0,0x6e,0xb7,0xb1,
	0xb8,0xb8,0x48,0x33,0x8f,0xc5,0x7d,0xe2,0x79,0x9e,0xee,0x4a,0x87,0xc3,0x81,0x48,
	0x24,0x82,0x9d,0x9d,0x1d,0x04,0x02,0x01,0x94,0xcb,0xe5,0x91,0x05,0x80,0x90,0x56,
	0xeb,0xeb,0xeb,0x58,0x5a,0x5a,0x82,0x56,0xab,0xa5,0x2e,0x66,0x20,0x10,0x80,0x56,
	0xab,0x1d,0x29,0xe7,0x90,0xac,0x17,0xc1,0x60,0xc3,0x9a,0xa8,0xa1,0x35,0x40,0xbd,
	0x5e,0x47,0x3a,0x9d,0x46,0x20,0x10,0xa0,0x36,0x78,0x94,0x9d,0x38,0x31,0x31,0x01,
	0x9f,0xcf,0x87,0xaf,0xbe,0xfa,0x0a,0x8f,0x1f,0x3f,0xee,0x0a,0xb7,0xf6,0xb2,0xf9,
	0xa9,0x54,0x0a,0x81,0x40,0x00,0x2f,0x5e,0xbc,0x38,0xa7,0x72,0x47,0x6d,0x1a,0x8d,
	0x06,0x1a,0x8d,0x06,0x6a,0xb5,0x1a,0x1c,0xc7,0xa1,0x56,0xab,0xd1,0xf1,0x7c,0xf7,
	0xdd,0x77,0x68,0xb7,0xdb,0xa8,0x54,0x2a,0x70,0x38,0x1c,0x58,0x5e,0x5e,0x96,0x74,
	0x05,0x4d,0x26,0x13,0x4c,0x26,0x13,0xe6,0xe7,0xe7,0xe1,0x74,0x3a,0xc1,0xb2,0x2c,
	0x72,0xb9,0xdc,0x85,0x78,0x01,0x95,0x4a,0x05,0xbb,0xdd,0x8e,0x07,0x0f,0x1e,0xe0,
	0xd1,0xa3,0x47,0x60,0x18,0x06,0x1b,0x1b,0x1b,0x78,0xf5,0xea,0x15,0x36,0x36,0x36,
	0xc0,0x30,0xcc,0xc8,0x39,0x87,0x64,0xc3,0x6a,0x34,0x1a,0x94,0x4a,0xa5,0xa1,0xcc,
	0xd1,0x40,0x01,0x20,0xc4,0x42,0xbb,0xdd,0x46,0xb1,0x58,0x44,0x36,0x9b,0xa5,0xf9,
	0x7a,0xbd,0x10,0xae,0x94,0xad,0x53,0x28,0x14,0x5d,0x39,0x7f,0x83,0x8a,0x29,0x5f,
	0xf6,0xf7,0xa4,0x34,0x90,0x30,0x7a,0x48,0x6a,0x02,0x91,0xf7,0x13,0x60,0x5a,0x2c,
	0x16,0x07,0xe6,0xf8,0xa9,0xd5,0x6a,0xb8,0x5c,0x2e,0x1c,0x1c,0x1c,0x50,0xca,0xf6,
	0x22,0x7e,0xff,0xf8,0xf8,0x38,0xac,0x56,0x2b,0x05,0xc4,0x84,0x65,0x24,0x67,0x11,
	0x7b,0xe5,0x28,0x0e,0xc2,0x6c,0xa3,0xf0,0x14,0x7d,0x4d,0x00,0x39,0x97,0x47,0xd4,
	0x0f,0x31,0x05,0xbd,0xd4,0x5d,0xbf,0x45,0xa9,0x54,0x2a,0x68,0x34,0x1a,0x34,0x8a,
	0x36,0xcc,0x8e,0x25,0xc8,0x78,0x54,0xf5,0x3a,0x4a,0x08,0x56,0xf8,0xee,0x4e,0xa7,
	0x03,0xa5,0x52,0x39,0x14,0xf8,0x22,0xd9,0x43,0x17,0xe5,0x05,0x84,0xf4,0xad,0x50,
	0x28,0x84,0x8b,0x2d,0xa4,0xc8,0xaf,0xab,0xb1,0x83,0x88,0x20,0x61,0x07,0x89,0x0a,
	0xbd,0x48,0x0e,0xdc,0xb0,0x7e,0xb4,0x70,0x97,0x0d,0x93,0x73,0x77,0x91,0xcc,0x1b,
	0x31,0x7f,0x7e,0x91,0xf1,0x8d,0xc2,0x0b,0x0c,0x72,0xb3,0x85,0xff,0x16,0x86,0xa1,
	0xc5,0x61,0xe9,0x4f,0x2a,0x00,0x42,0x22,0x68,0x98,0x1d,0x32,0xa8,0x7a,0xc7,0xa0,
	0x1d,0x23,0x85,0x01,0x86,0xf9,0xbd,0x8b,0x50,0xc7,0x42,0x0d,0x47,0x98,0x37,0x8d,
	0x46,0x33,0x50,0xc3,0x5d,0x46,0xa3,0x49,0xf5,0x85,0x10,0x55,0x24,0xbe,0x42,0x04,
	0x40,0xad,0x56,0x53,0xcd,0x2b,0xc5,0xaa,0x7e,0x12,0x01,0x68,0xb5,0x5a,0x28,0x14,
	0x0a,0xc8,0x64,0x32,0x88,0xc7,0xe3,0x88,0xc7,0xe3,0xc8,0x66,0xb3,0x7d,0x6d,0x64,
	0x2f,0x21,0x20,0x36,0xd3,0x6c,0x36,0xd3,0xb0,0xf2,0xa0,0xdd,0x15,0x8d,0x46,0x07,
	0xfe,0xde,0xa5,0x07,0x2f,0xc0,0x05,0x83,0x30,0x87,0xd4,0x77,0x85,0xbc,0x80,0x58,
	0x6b,0x0c,0xda,0x10,0xe2,0x5a,0x83,0x42,0xf3,0x24,0x8c,0x69,0x5c,0xf7,0x99,0x43,
	0xae,0xdf,0x0e,0x24,0x28,0x99,0xec,0xd8,0xbd,0xbd,0x3d,0xa4,0xd3,0xe9,0xa1,0x6d,
	0xf2,0xf8,0xf8,0x38,0xe5,0xfb,0xbd,0x5e,0x2f,0xee,0xdd,0xbb,0x47,0xc3,0xb4,0xbd,
	0xd8,0x2c,0x52,0x96,0xe5,0xf0,0xf0,0x10,0x3b,0x3b,0x3b,0x48,0xa5,0x52,0x57,0x8a,
	0x01,0xa4,0xdc,0x26,0x72,0xca,0x27,0x9d,0x4e,0x63,0x7b,0x7b,0x1b,0x3c,0xcf,0x23,
	0x91,0x48,0xc0,0x66,0xb3,0xc1,0x68,0x34,0x62,0x72,0x72,0xf2,0x5c,0x9f,0x2f,0xcb,
	0x0b,0x90,0x08,0xa5,0xf0,0x5c,0x01,0xa9,0x28,0x36,0x2a,0xc0,0xbd,0x16,0x01,0x20,
	0x7e,0x78,0xa7,0xd3,0x41,0x28,0x14,0xa2,0x81,0x98,0x78,0x3c,0x3e,0x74,0x2c,0x7c,
	0x6e,0x6e,0x0e,0xeb,0xeb,0xeb,0x58,0x5b,0x5b,0x83,0xcf,0xe7,0x83,0xd5,0x6a,0xc5,
	0xec,0xec,0x6c,0x4f,0x9f,0x36,0x93,0xc9,0x50,0xae,0x9f,0x1c,0xfe,0x24,0x87,0x36,
	0xaf,0x65,0xf0,0xff,0xef,0xd4,0x91,0x90,0xe7,0x20,0x94,0x32,0x11,0xd8,0x95,0x95,
	0x15,0x68,0xb5,0xda,0x73,0x02,0x70,0x59,0x5e,0x80,0x44,0x50,0x85,0xd1,0x50,0xa1,
	0xcd,0xbf,0x88,0x89,0xbb,0x16,0x0d,0x70,0x7c,0x7c,0xdc,0x95,0xff,0x2e,0x2c,0xbd,
	0x3a,0x08,0xc4,0x39,0x9d,0x4e,0xac,0xad,0xad,0xe1,0xc9,0x93,0x27,0xf4,0xd0,0x47,
	0x2f,0xa9,0x16,0x9e,0xf7,0x7f,0xfe,0xfc,0x39,0x0e,0x0f,0x0f,0x2f,0xe5,0xf7,0x8f,
	0xaa,0x01,0x08,0xd3,0x49,0x02,0x4c,0x89,0x44,0x02,0xed,0x76,0x1b,0x26,0x93,0x09,
	0x5e,0xaf,0xf7,0xca,0x79,0x01,0x42,0x37,0x0b,0xcd,0x1b,0x09,0x06,0x89,0x13,0x63,
	0x3e,0x99,0x00,0x88,0x13,0x36,0x86,0x45,0xec,0x52,0x8b,0xef,0xf5,0x7a,0x31,0x3f,
	0x3f,0x8f,0xf9,0xf9,0xf9,0xae,0xc5,0x17,0x46,0xcc,0xc8,0xef,0x11,0xae,0x3f,0x18,
	0x0c,0x22,0x18,0x0c,0x4a,0x2e,0xfe,0x75,0xa8,0x45,0xa1,0xbd,0x15,0x6b,0xbf,0x68,
	0x34,0x8a,0xf9,0xf9,0x79,0x14,0x0a,0x85,0x81,0xac,0x1a,0xc1,0x38,0xc1,0x60,0x90,
	0x9e,0x62,0x1e,0xe4,0xe2,0xda,0xed,0x76,0xe8,0xf5,0x7a,0x14,0x8b,0x45,0x24,0x93,
	0x49,0x34,0x1a,0x0d,0xa4,0x52,0x29,0xea,0xf7,0xf7,0xea,0xdb,0x27,0xd3,0x00,0x17,
	0x61,0xb6,0x26,0x26,0x26,0x60,0x34,0x1a,0x29,0xd7,0xbf,0xb6,0xb6,0x06,0xa7,0xd3,
	0x29,0xe9,0x56,0xd5,0xeb,0x75,0x9c,0x9c,0x9c,0x20,0x9f,0xcf,0x23,0x95,0x4a,0x5d,
	0x9a,0xeb,0xbf,0x8c,0x10,0xf4,0x32,0x81,0x24,0x7f,0x70,0x58,0xaa,0x59,0x98,0xa1,
	0x3c,0x88,0xfb,0x37,0x99,0x4c,0x30,0x1a,0x8d,0xb4,0x6e,0xe1,0xd9,0xd9,0x19,0xb6,
	0xb6,0xb6,0x90,0x48,0x24,0x50,0xab,0xd5,0xa0,0xd3,0xe9,0xba,0xb4,0xd3,0x27,0x11,
	0x80,0xcb,0xa4,0x21,0x13,0x9b,0x28,0xe4,0xfa,0x9d,0x4e,0x27,0xe6,0xe6,0xe6,0x7a,
	0x4e,0x70,0x3c,0x1e,0xc7,0xf6,0xf6,0xf6,0x48,0x5c,0xff,0x55,0xdb,0xc5,0x5e,0xef,
	0x23,0x31,0x83,0x5e,0x19,0x46,0x52,0x26,0xac,0x1f,0x71,0x23,0xe6,0xfe,0xf5,0x7a,
	0x3d,0x0a,0x85,0x02,0x35,0x37,0x99,0x4c,0x06,0xe1,0x70,0x18,0x91,0x48,0x04,0xed,
	0x76,0x9b,0xe2,0x93,0xeb,0xe6,0x01,0xb8,0xab,0x9a,0x60,0x95,0x4a,0x05,0xab,0xd5,
	0x8a,0x95,0x95,0x15,0xca,0xf5,0xf7,0x23,0x54,0x84,0x5e,0xc6,0x30,0x5c,0xff,0x75,
	0x01,0xa2,0x5e,0x60,0x8b,0xe4,0x03,0x0e,0x9b,0x38,0x42,0x4e,0x2e,0xf7,0x32,0x17,
	0x62,0xee,0x5f,0xa1,0x50,0xd0,0x5a,0x03,0xe4,0x96,0x31,0xe1,0xf8,0xc5,0xf8,0xe4,
	0xc6,0x9b,0x80,0x41,0x7e,0xb1,0xd4,0xc4,0x5f,0x25,0xd7,0x7f,0x1d,0x1c,0x81,0x54,
	0x0e,0x5d,0xbf,0xd8,0x85,0xf0,0x23,0xf5,0xbe,0xb1,0xb1,0x31,0xd8,0x6c,0x36,0xca,
	0xfd,0x87,0x42,0x21,0x5a,0x73,0x48,0x3c,0xfe,0x4f,0xc5,0x05,0x8c,0x8c,0x30,0x7a,
	0x75,0xe8,0xa6,0x70,0xfd,0x57,0xed,0x26,0x92,0x0c,0xa7,0x61,0x1a,0xa1,0x76,0xa5,
	0x98,0xce,0x41,0x55,0xc7,0x46,0x99,0xeb,0xcf,0x26,0x00,0xfd,0x3a,0x73,0x53,0xb8,
	0xfe,0xab,0x04,0x87,0x24,0x56,0x30,0x4c,0x6c,0x40,0x9c,0x43,0x29,0x25,0x00,0xe2,
	0x9c,0xbf,0x41,0x75,0x07,0x3f,0x05,0x17,0x70,0x65,0x3e,0xc6,0x4d,0xe0,0xfa,0xaf,
	0xba,0x91,0x83,0x22,0xc3,0x10,0x51,0xc2,0x93,0x39,0x52,0x1a,0x90,0xe3,0x38,0x7a,
	0x2b,0x89,0x70,0xd3,0x90,0xcd,0xf0,0xb9,0xc6,0x3f,0x92,0x00,0xdc,0x36,0xae,0xff,
	0x32,0x8d,0xe4,0xd8,0x65,0x32,0x99,0xa1,0x63,0x03,0x3a,0x9d,0x0e,0x46,0xa3,0xf1,
	0x5c,0x3e,0x9f,0x56,0xab,0x85,0xcd,0x66,0x83,0x5a,0xad,0xc6,0xe9,0xe9,0x29,0x92,
	0xc9,0x24,0x62,0xb1,0x18,0x92,0xc9,0xe4,0x67,0xaf,0x31,0xc4,0x0d,0x23,0xd9,0xbd,
	0x54,0xf1,0xe7,0xe0,0xfa,0x87,0x4d,0x24,0xbd,0x6c,0x23,0x5e,0xca,0xf6,0xf6,0x36,
	0xda,0xed,0x36,0x62,0xb1,0xd8,0xc0,0xd8,0x80,0xc9,0x64,0xa2,0xd9,0x44,0x0b,0x0b,
	0x0b,0xa8,0x56,0xab,0x94,0xeb,0x37,0x18,0x0c,0x98,0x9a,0x9a,0x42,0x26,0x93,0xc1,
	0xff,0xfe,0xf7,0x3f,0x94,0x4a,0x25,0xbc,0x7b,0xf7,0x0e,0x89,0x44,0xe2,0xb3,0x62,
	0x20,0xee,0xa2,0x36,0x1f,0xf8,0xf4,0x5c,0xff,0xa7,0xac,0xc6,0x49,0x62,0x21,0x95,
	0x4a,0x05,0xf1,0x78,0x1c,0x6e,0xb7,0x7b,0x60,0x6c,0xc0,0x66,0xb3,0x01,0xf8,0x2d,
	0xd5,0xbd,0x54,0x2a,0xd1,0xf3,0x93,0x0c,0xc3,0xa0,0x52,0xa9,0xe0,0xe4,0xe4,0x04,
	0xf1,0x78,0x1c,0x3f,0xfe,0xf8,0x23,0x8e,0x8e,0x8e,0x68,0xb5,0xd3,0x4f,0x49,0x7c,
	0x5d,0x99,0x1b,0x78,0xd3,0xb9,0xfe,0xab,0xd0,0x00,0xb9,0x5c,0x0e,0xb9,0x5c,0x0e,
	0xc1,0x60,0x90,0x66,0x0e,0xf7,0x8a,0x0d,0x28,0x95,0x4a,0x98,0x4c,0x26,0x4c,0x4c,
	0x4c,0xc0,0xef,0xf7,0xd3,0x0a,0xa2,0x24,0x41,0x33,0x99,0x4c,0xe2,0xcd,0x9b,0x37,
	0xd8,0xde,0xde,0xc6,0xeb,0xd7,0xaf,0xa9,0x70,0x7d,0x76,0x4f,0xe7,0xa2,0x2c,0xd9,
	0xe7,0xe0,0xfa,0xc5,0x87,0x21,0x49,0xa5,0x6f,0xa9,0x60,0xd5,0x55,0xda,0x55,0x82,
	0x59,0xfc,0x7e,0x7f,0x4f,0xcc,0x22,0xbe,0x49,0x54,0x4a,0x3b,0xec,0xec,0xec,0xa0,
	0x50,0x28,0x20,0x91,0x48,0xdc,0x88,0xc5,0x1f,0x49,0x03,0xdc,0x34,0xae,0x9f,0xc4,
	0xe3,0x1d,0x0e,0x07,0x66,0x67,0x67,0x01,0xfc,0xff,0x70,0x75,0x3a,0x9d,0xbe,0x72,
	0xed,0x32,0xc8,0x6b,0x19,0xd4,0x08,0xad,0x2c,0xce,0x43,0xbc,0x35,0x02,0x70,0xd3,
	0xb8,0x7e,0xd2,0x9f,0x47,0x8f,0x1e,0xd1,0xb4,0xe9,0xbd,0xbd,0x3d,0x30,0x0c,0x83,
	0x5f,0x7f,0xfd,0xf5,0xca,0x05,0x60,0x58,0xde,0xa2,0x9f,0x00,0x91,0xc2,0x92,0x3c,
	0xcf,0xf7,0x24,0x7f,0x6e,0xb4,0x06,0xb8,0x49,0x5c,0x3f,0xd1,0x00,0x2b,0x2b,0x2b,
	0x78,0xf8,0xf0,0x21,0x65,0xd9,0xe2,0xf1,0x38,0x76,0x77,0x77,0xaf,0x7c,0xa2,0xc4,
	0xcc,0xe5,0x45,0x0e,0x97,0x0a,0x33,0x80,0x86,0x3d,0x3e,0x77,0x63,0x78,0x80,0xeb,
	0xe0,0xfa,0x2f,0x43,0x75,0x0a,0xfb,0xe3,0x70,0x38,0xe0,0x70,0x38,0x30,0x37,0x37,
	0x07,0x83,0xc1,0x70,0x2d,0x01,0x94,0x51,0x73,0x06,0xfb,0xb1,0x8b,0x37,0xe9,0x32,
	0x69,0x6e,0x58,0x3f,0xfb,0x73,0x71,0xfd,0xc3,0xf4,0x47,0x68,0x67,0xaf,0x2b,0x7c,
	0x3a,0x2a,0x2f,0x20,0x35,0x1f,0x37,0xf1,0x5e,0x01,0x6e,0x58,0x3f,0x5b,0xcc,0xf5,
	0x8b,0x8f,0x8b,0x0f,0xb2,0x99,0xbd,0x54,0xde,0xa0,0xea,0x9e,0x83,0xfa,0x23,0x44,
	0xd3,0xd7,0x79,0x90,0x62,0x54,0x5e,0x40,0x6a,0x3e,0x46,0xc9,0x2f,0xb8,0x91,0x18,
	0x40,0xc8,0xf5,0x0f,0x12,0x00,0x31,0x6a,0x16,0x0b,0xc0,0x65,0x17,0x49,0x58,0xd7,
	0xb7,0x52,0xa9,0x80,0x65,0x59,0x1a,0x8f,0xbf,0x0e,0x01,0x18,0x95,0x17,0x90,0x12,
	0xa0,0x51,0x32,0x8c,0x3e,0x0b,0x06,0x18,0x96,0xeb,0x1f,0x64,0xc3,0xc8,0xdd,0xbd,
	0xe9,0x74,0x1a,0x67,0x67,0x67,0x17,0xae,0x7a,0x31,0x4a,0x7f,0x48,0x24,0xae,0xd7,
	0x24,0x4b,0xbd,0x6b,0x50,0xee,0xfe,0x20,0x5e,0x60,0xd8,0x58,0x06,0x79,0x3e,0x93,
	0xc9,0xd0,0x52,0x3a,0xa3,0x8c,0x7d,0xd8,0xda,0x03,0x17,0x19,0x0f,0x37,0x2a,0xd7,
	0x6f,0xb5,0x5a,0x25,0xd5,0x5d,0xad,0x56,0xc3,0x87,0x0f,0x1f,0x68,0x19,0x12,0xc2,
	0xf5,0x87,0x42,0xa1,0xae,0xba,0x74,0x97,0x69,0x13,0x13,0x13,0xd4,0xf7,0x9f,0x9f,
	0x9f,0xc7,0x17,0x5f,0x7c,0x41,0xfb,0x53,0x28,0x14,0xa8,0x49,0x90,0x22,0x59,0x08,
	0x66,0x10,0xd6,0xdc,0x23,0x42,0x73,0x11,0x52,0x66,0x10,0x2f,0x50,0xab,0xd5,0x70,
	0x72,0x72,0x82,0xa3,0xa3,0x23,0x7a,0xa7,0xe1,0xce,0xce,0x0e,0x32,0x99,0xcc,0xd0,
	0x27,0x8f,0xa4,0x0a,0x3b,0xf6,0x6b,0xfd,0xf2,0x11,0x7a,0x99,0xd7,0xbe,0x26,0x40,
	0xcc,0xf5,0x13,0xd0,0x23,0xc5,0x76,0x55,0xab,0x55,0x44,0x22,0x11,0xbc,0x79,0xf3,
	0x06,0x5b,0x5b,0x5b,0x94,0xeb,0xcf,0xe7,0xf3,0x57,0xa6,0xf6,0x2c,0x16,0x0b,0xd6,
	0xd7,0xd7,0xb1,0xba,0xba,0x0a,0xbf,0xdf,0x0f,0xbf,0xdf,0x0f,0x87,0xc3,0x41,0x4d,
	0x13,0xc1,0x05,0xfd,0xe2,0xf1,0xc2,0xbe,0x90,0x8a,0x5a,0x17,0x39,0x77,0x30,0x88,
	0x17,0x10,0xd6,0x37,0xf8,0xe5,0x97,0x5f,0x10,0x89,0x44,0x90,0x4a,0xa5,0x90,0xcf,
	0xe7,0x87,0xfa,0x3d,0x61,0xfe,0xc0,0xb0,0x1a,0xa0,0x5f,0x3e,0xc2,0xc8,0x18,0xa0,
	0x1f,0xd7,0x2f,0xd5,0x1a,0x8d,0x06,0xb2,0xd9,0x2c,0x76,0x77,0x77,0xb1,0xb1,0xb1,
	0x81,0x58,0x2c,0x76,0xe5,0x44,0x8c,0xc3,0xe1,0xc0,0xea,0xea,0x2a,0x9e,0x3c,0x79,
	0x82,0xf9,0xf9,0xf9,0x2e,0x4d,0x44,0xea,0x0e,0x92,0x00,0x8c,0x98,0x68,0x21,0x07,
	0x40,0x84,0xe6,0x8b,0x54,0xd3,0x54,0xa9,0x54,0x23,0x7b,0x2a,0x83,0x78,0x01,0xa1,
	0xd7,0xf0,0xf2,0xe5,0x4b,0x5a,0xd7,0x70,0x10,0xb8,0x15,0xf7,0x77,0x58,0xaf,0x46,
	0x9c,0x8f,0x30,0x74,0x81,0x88,0x5e,0x09,0x91,0x3e,0x9f,0x0f,0x0b,0x0b,0x0b,0x58,
	0x58,0x58,0x38,0x37,0xd9,0xa3,0xb8,0x6b,0x6a,0xb5,0x1a,0x7a,0xbd,0xbe,0x6b,0x82,
	0x86,0x91,0x68,0x52,0xb0,0xa1,0x56,0xab,0xd1,0x3a,0x7d,0xf3,0xf3,0xf3,0xf0,0xfb,
	0xfd,0x92,0xfd,0x51,0x28,0x14,0x34,0x1e,0xef,0x76,0xbb,0xbb,0xea,0xe4,0x68,0xb5,
	0x5a,0xb8,0x5c,0x2e,0x18,0x8d,0x46,0xe8,0x74,0x3a,0xca,0x13,0x90,0xe7,0x5d,0x2e,
	0x17,0xa2,0xd1,0x68,0xdf,0xa2,0x4a,0x62,0x2d,0x26,0xe6,0x05,0x7c,0x3e,0xdf,0xb9,
	0x3e,0x55,0x2a,0x15,0x7a,0xa5,0xbd,0xb8,0xa0,0x95,0x30,0x1b,0x88,0x78,0x07,0xe2,
	0xa2,0x56,0x66,0xb3,0x79,0xa8,0x73,0x06,0xc0,0xf9,0xba,0x8e,0x83,0x8a,0x44,0x91,
	0xf1,0x70,0x42,0x6a,0x75,0x7a,0x7a,0x1a,0x73,0x73,0x73,0x70,0x3a,0x9d,0xf0,0xfb,
	0xfd,0x58,0x5b,0x5b,0xc3,0xe2,0xe2,0xe2,0x50,0x7e,0xff,0xd8,0xd8,0x18,0x1c,0x0e,
	0x07,0xee,0xdf,0xbf,0x0f,0x00,0x38,0x3a,0x3a,0x02,0xc3,0x30,0xd0,0xe9,0x74,0xb4,
	0x94,0xfa,0x28,0x47,0x9e,0x3a,0x9d,0x0e,0x55,0x83,0x1c,0xc7,0x61,0x6e,0x6e,0x0e,
	0x2b,0x2b,0x2b,0x3d,0x85,0x71,0x6c,0x6c,0x0c,0x2e,0x97,0x0b,0x0f,0x1e,0x3c,0x80,
	0x56,0xab,0xa5,0xb5,0xf2,0x88,0x00,0x90,0xef,0xdb,0x6c,0x36,0x6a,0xc2,0x6c,0x36,
	0x1b,0xbe,0xf8,0xe2,0x0b,0x30,0x0c,0x83,0x5c,0x2e,0x47,0xe7,0x41,0x58,0x56,0x8d,
	0xd4,0x41,0x14,0x13,0x3f,0xc2,0x0a,0x26,0xad,0x56,0x0b,0xc9,0x64,0x12,0x77,0xee,
	0xdc,0x81,0xdd,0x6e,0x07,0xf0,0x5b,0xdd,0x5f,0x52,0x2d,0x4d,0x8a,0xf6,0x25,0xcc,
	0x2a,0x21,0xb0,0xf4,0x7a,0xfd,0xb9,0xb2,0x76,0xcb,0xcb,0xcb,0x70,0xbb,0xdd,0x18,
	0x1f,0x1f,0x1f,0x38,0x5f,0xe2,0x3b,0x97,0x7a,0x95,0x89,0x13,0x8f,0x87,0x13,0xee,
	0x54,0x92,0xb7,0x4e,0x6c,0xac,0xd3,0xe9,0xa4,0x81,0x96,0x61,0x82,0x1d,0x7e,0xbf,
	0x1f,0x3c,0xcf,0x63,0x61,0x61,0x81,0x96,0x28,0x21,0x52,0x3e,0x2a,0xfb,0x45,0x8e,
	0x4f,0x13,0xfa,0xd4,0x60,0x30,0xc0,0x62,0xb1,0xd0,0x09,0x96,0xda,0x01,0xe4,0xc6,
	0xd0,0xf9,0xf9,0x79,0x7a,0x55,0x2c,0xe9,0x83,0xd4,0xf7,0xed,0x76,0x3b,0x3a,0x9d,
	0x0e,0x1c,0x0e,0x07,0x4a,0xa5,0xd2,0xb9,0xc2,0x8a,0x81,0x40,0x00,0x9d,0x4e,0x07,
	0xc7,0xc7,0xc7,0xe7,0x04,0x40,0xcc,0x0b,0xf8,0xfd,0x7e,0x9c,0x9d,0x9d,0x41,0xad,
	0x56,0x63,0x76,0x76,0x16,0x6a,0xb5,0x1a,0x63,0x63,0x63,0xb4,0xbc,0xad,0x58,0x08,
	0x78,0x9e,0x87,0xdd,0x6e,0xc7,0xa3,0x47,0x8f,0x70,0xff,0xfe,0x7d,0x98,0xcd,0x66,
	0xc9,0xc2,0x96,0x56,0xab,0x75,0x28,0x66,0x93,0xd4,0x1a,0xe6,0x79,0x1e,0x3e,0x9f,
	0x4f,0xb2,0x50,0xa4,0xd4,0x78,0x38,0xe1,0x02,0x9a,0xcd,0x66,0xdc,0xbd,0x7b,0x17,
	0x5f,0x7f,0xfd,0x35,0x4d,0x5d,0x1e,0x15,0xa5,0x1b,0x0c,0x06,0xf8,0xfd,0x7e,0x8a,
	0x5e,0x2f,0x43,0xf9,0x8a,0x8b,0x45,0x13,0xdf,0xbf,0x57,0x33,0x18,0x0c,0x98,0x9f,
	0x9f,0x87,0xcb,0xe5,0xea,0xaa,0x3f,0x4c,0x8e,0x81,0x8b,0xbf,0xaf,0x54,0x2a,0xe1,
	0xf1,0x78,0x60,0xb3,0xd9,0xd0,0x6e,0xb7,0xbb,0xd0,0x7c,0x3c,0x1e,0x47,0xa5,0x52,
	0x41,0x28,0x14,0xea,0x59,0xc5,0xec,0xe8,0xe8,0x08,0x47,0x47,0x47,0x08,0x85,0x42,
	0x48,0xa5,0x52,0xd4,0xd4,0x90,0x4d,0x23,0xcc,0x2a,0x16,0xde,0x5a,0x4e,0x7e,0x7b,
	0x66,0x66,0x06,0x0b,0x0b,0x0b,0x78,0xf8,0xf0,0x21,0x1c,0x0e,0x47,0x97,0xe9,0x20,
	0x09,0xa9,0xa3,0x6c,0x1c,0xbd,0x5e,0x4f,0xc7,0x3f,0xec,0x78,0x38,0x31,0x4f,0x2d,
	0x2e,0xfc,0x4c,0xae,0x5c,0x17,0xba,0x23,0x52,0xf6,0x5e,0xaa,0x58,0xf1,0x30,0xe5,
	0xe3,0x87,0xe1,0xce,0x85,0x95,0x46,0x85,0xc5,0x9e,0x85,0xe7,0xea,0xc5,0xbf,0x4f,
	0x0a,0x40,0x08,0x11,0x32,0x39,0xe7,0x27,0x2e,0x77,0x2f,0xac,0x18,0x7e,0x91,0x56,
	0xad,0x56,0x11,0x0a,0x85,0x70,0x70,0x70,0x80,0x83,0x83,0x03,0xcc,0xce,0xce,0x82,
	0x65,0x59,0xe4,0xf3,0xf9,0xae,0x3b,0x89,0x46,0x89,0x73,0x10,0x97,0x6e,0xd8,0x62,
	0xda,0x52,0xf3,0x3f,0x92,0x17,0xd0,0x68,0x34,0x90,0xcf,0xe7,0xb1,0xbf,0xbf,0x0f,
	0x8d,0x46,0x43,0x2b,0x70,0x93,0xf2,0xae,0x84,0x61,0xeb,0x55,0xce,0xbd,0xdf,0x9d,
	0x3f,0x97,0x69,0x83,0xca,0xcb,0x0b,0x05,0x40,0x5c,0x2e,0x5d,0xd8,0x4f,0x71,0xb9,
	0x78,0xb2,0x43,0x55,0x2a,0x15,0x45,0xdc,0x04,0x90,0x35,0x1a,0x0d,0x64,0x32,0x19,
	0xc9,0xda,0xba,0xfd,0xfc,0xf6,0x58,0x2c,0x86,0xad,0xad,0x2d,0xd4,0xeb,0x75,0x28,
	0x14,0x0a,0xec,0xef,0xef,0xf7,0xac,0xa7,0x40,0xe6,0x7b,0x6f,0x6f,0x8f,0x46,0x31,
	0xc9,0x6f,0x13,0xd6,0x70,0x94,0x72,0xfa,0xe2,0xf1,0x0f,0x3b,0x1e,0x4e,0x28,0xc5,
	0xf1,0x78,0x1c,0x0c,0xc3,0x20,0x16,0x8b,0x41,0xa7,0xd3,0x51,0x5b,0x47,0x50,0xa3,
	0xd4,0xd9,0x41,0xf1,0x95,0x24,0xe4,0x33,0x4c,0xf9,0xf8,0x61,0xc9,0x0a,0xa1,0x9b,
	0x27,0xbc,0x40,0x41,0x5c,0x59,0x43,0xfc,0xfb,0x52,0x57,0xbe,0x08,0x99,0x42,0xe2,
	0x06,0x92,0xef,0x10,0x37,0x91,0x68,0x0b,0xa9,0xda,0xba,0xfd,0x1a,0xc9,0x79,0x8c,
	0xc7,0xe3,0x54,0x03,0xf4,0xaa,0xa7,0x20,0x9c,0x6f,0x72,0x47,0x11,0xa9,0x54,0x42,
	0x76,0xbd,0xd4,0x78,0x87,0x9d,0xff,0x61,0xc7,0x43,0xaf,0x8c,0x21,0x29,0x56,0xe4,
	0x56,0x0e,0xa2,0x42,0x86,0xa5,0x17,0x2f,0x7b,0x7d,0xcc,0x28,0xb8,0x40,0x4a,0xa8,
	0x86,0xf9,0x7d,0xf1,0x77,0x87,0xb9,0x62,0xa5,0x97,0x1b,0x28,0xd5,0x48,0x31,0x4a,
	0x61,0x65,0xf1,0x5e,0x29,0x6a,0x52,0xf3,0x2d,0xe5,0x25,0x0d,0x7b,0xad,0x8e,0xd4,
	0xf8,0x87,0x19,0x0f,0xc3,0x30,0x4c,0xe7,0x2a,0x82,0x33,0xbf,0xf7,0x26,0x95,0xb3,
	0x38,0xca,0xf9,0x45,0xa9,0x9d,0x7b,0x13,0xc6,0xc3,0xca,0x4b,0xfb,0x69,0x27,0xfd,
	0x26,0x85,0x82,0x01,0xe0,0xff,0x00,0x6c,0x88,0x2a,0x33,0x6f,0xd9,0x21,0xf3,0x00,
	0x00,0x00,0x00,0x49,0x45,0x4e,0x44,0xae,0x42,0x60,0x82
};

GtkWindow *window;
GtkListStore *store;
GtkTreeSelection *selection;
GtkTreeIter iter;
GtkToolItem *modeButton;
GtkToolItem *scanButton;
GtkToolItem *connectButton;
char szFileName[256];

struct sockaddr_rc loc_addr = {0};
struct sockaddr_rc rem_addr = {0};
int theSocket;
int sdpSocket;
int iCursorSpeed = 3; // default cursor movement speed when direction held

void zm_bt_close(void);
void zm_bt_disconnect(void);
int zm_bt_connect(void);
int zm_bt_discovery(void);
void zm_process_buttons(uint32_t ulNewButtons);
void zm_update_list();
void zm_init(void);

static void zm_connect_bt_clicked(GtkWidget *widget, gpointer user_data)
{
   if (bConnected)
   {
	gtk_tool_button_set_label((GtkToolButton *)connectButton, "Connect");
	zm_bt_disconnect();
	bConnected = FALSE;
   }
   else
   {
	if (zm_bt_connect())
	{
		gtk_tool_button_set_label((GtkToolButton *)connectButton, "Disconnect");
		bConnected = TRUE;
		iMouseMode = iDeviceMode[iDevice];
	}
   }
} /* zm_connect_bt_clicked() */

static void zm_mode_clicked(GtkWidget *widget, gpointer user_data)
{
char szKey[64];

	iDeviceMode[iDevice]++; // cycle through them
	if (iDeviceMode[iDevice] >= MOUSE_MODE_COUNT)
	{
		iDeviceMode[iDevice] = 0; // wrap around to 0
	}
	// save it in the settings
	sprintf(szKey,"devicemode%d", iDevice);
	g_settings_set_int(mySettings, szKey, iDeviceMode[iDevice]);

	zm_update_list(); // display the new mode for this device
} /* zm_mode_clicked() */

static void zm_scan_bt_clicked(GtkWidget *widget, gpointer user_data)
{
   zm_bt_discovery(); // find supported devices

} /* zm_scan_bt_clicked() */

gboolean zm_treeview_select(GtkTreeSelection *select,
				GtkTreeModel *mode,
				GtkTreePath *path,
				gboolean path_currently_selected,
				gpointer	userdata)
{
	gint *pindices = gtk_tree_path_get_indices(path);
//	g_print("path index 0 = %d, currently selected = %d\n", pindices[0], path_currently_selected);
	if (!path_currently_selected) // about to select this row
		iDevice = pindices[0]; // this is the new selected device
	return (!bConnected); // allow selection to change if not currently connected
} /* zm_treeview_select() */

static void
activate (GtkApplication *app,
          gpointer        user_data)
{

  GtkWidget *toolbar;
  GtkTreeView *treeview;
  GtkWidget *scrollwindow;
  GtkCellRenderer *renderer;
//  GtkTreeModel *model;
  GtkBox *box;
//  GtkToolItem *openTb;
  GtkToolItem *sep;
//  GtkToolItem *exitTb;
  GdkRGBA color;
//  GError *err;
  GtkTreeViewColumn *column;
  GdkPixbufLoader *loader;
  GdkPixbuf *pixbuf;
  char szTemp[256];

  color.red = 0xffff;
  color.blue = 0xffff;
  color.green = 0xffff;
  color.alpha = 0xffff;

  window = (GtkWindow *)gtk_application_window_new (app);
  sprintf(szTemp, "ZeeMouse %d.%d", ZEEMOUSE_MAJOR_VERSION, ZEEMOUSE_MINOR_VERSION);
  gtk_window_set_title (GTK_WINDOW (window), szTemp);
  gtk_window_set_default_size (GTK_WINDOW (window), 665, 400);
  loader = gdk_pixbuf_loader_new();
  // icon image must be 128x128 32-bpp or it will fail
  gdk_pixbuf_loader_write(loader, ucIcon, sizeof(ucIcon), NULL);
  pixbuf = gdk_pixbuf_loader_get_pixbuf(loader);
  gtk_window_set_icon(window, pixbuf);
//  gtk_window_set_icon_from_file(window, "./tifftool_256.png", &err);
  gtk_widget_override_background_color(GTK_WIDGET(window), GTK_STATE_NORMAL, &color);

  box = (GtkBox *)gtk_box_new(GTK_ORIENTATION_VERTICAL, 5);
  gtk_container_add(GTK_CONTAINER(window), GTK_WIDGET(box));

  toolbar = gtk_toolbar_new();
  gtk_toolbar_set_style(GTK_TOOLBAR(toolbar), GTK_TOOLBAR_ICONS);
//  openTb = gtk_tool_button_new(gtk_image_new_from_icon_name("document-open", GTK_ICON_SIZE_MENU), NULL);
//  gtk_toolbar_insert(GTK_TOOLBAR(toolbar), openTb, -1);
  scanButton = gtk_tool_button_new(NULL, "Scan");
  gtk_toolbar_insert(GTK_TOOLBAR(toolbar), scanButton, -1);
  modeButton = gtk_tool_button_new(NULL, "Mode");
  gtk_toolbar_insert(GTK_TOOLBAR(toolbar), modeButton, -1);
  sep = gtk_separator_tool_item_new();
  gtk_toolbar_insert(GTK_TOOLBAR(toolbar), sep, -1);
  connectButton = gtk_tool_button_new(NULL, "Connect");
  gtk_toolbar_insert(GTK_TOOLBAR(toolbar), connectButton, -1);
//  gtk_tool_item_set_expand(GTK_TOOL_ITEM(sep), -1);
//  gtk_separator_tool_item_set_draw(GTK_SEPARATOR_TOOL_ITEM(separator), FALSE);
//  exitTb = gtk_tool_button_new(gtk_image_new_from_icon_name("application-exit", GTK_ICON_SIZE_MENU), NULL);
//  gtk_toolbar_insert(GTK_TOOLBAR(toolbar), exitTb, -1);

  gtk_box_pack_start(box, toolbar, FALSE, FALSE, 4);
  g_signal_connect(modeButton, "clicked", G_CALLBACK(zm_mode_clicked), NULL);
  g_signal_connect(scanButton, "clicked", G_CALLBACK(zm_scan_bt_clicked), NULL);
  g_signal_connect(connectButton, "clicked", G_CALLBACK(zm_connect_bt_clicked), NULL);

  scrollwindow = gtk_scrolled_window_new(NULL, NULL);
  gtk_scrolled_window_set_policy(GTK_SCROLLED_WINDOW(scrollwindow), GTK_POLICY_NEVER, GTK_POLICY_AUTOMATIC); 

  treeview = (GtkTreeView *)gtk_tree_view_new();
  store = gtk_list_store_new(5, G_TYPE_STRING, G_TYPE_STRING, G_TYPE_STRING, G_TYPE_STRING, G_TYPE_STRING);
  gtk_tree_view_set_model(treeview, (GtkTreeModel *)store);
  renderer = gtk_cell_renderer_text_new();
  gtk_tree_view_insert_column_with_attributes(treeview, -1, "Device", renderer, "text", 0, NULL);
  gtk_tree_view_insert_column_with_attributes(treeview, -1, "Address", renderer, "text", 1, NULL);
  gtk_tree_view_insert_column_with_attributes(treeview, -1, "Mode", renderer, "text", 2, NULL);
  column = gtk_tree_view_get_column(treeview, 0);
  gtk_tree_view_column_set_sizing(column, GTK_TREE_VIEW_COLUMN_FIXED);
  gtk_tree_view_column_set_fixed_width(column, 200);
  column = gtk_tree_view_get_column(treeview, 1);
  gtk_tree_view_column_set_sizing(column, GTK_TREE_VIEW_COLUMN_FIXED);
  gtk_tree_view_column_set_fixed_width(column, 200);
  column = gtk_tree_view_get_column(treeview, 2);
  gtk_tree_view_column_set_sizing(column, GTK_TREE_VIEW_COLUMN_FIXED);
  gtk_tree_view_column_set_fixed_width(column, 160);
  selection = gtk_tree_view_get_selection(treeview);
  gtk_tree_selection_set_select_function(selection, zm_treeview_select, NULL, NULL);

  gtk_box_pack_end(box, GTK_WIDGET(scrollwindow), TRUE, TRUE, 0);
  gtk_container_add(GTK_CONTAINER(scrollwindow), GTK_WIDGET(treeview));

//  g_signal_connect (openTb, "clicked", G_CALLBACK (openClick), NULL);
//  g_signal_connect (exitTb, "clicked", G_CALLBACK (gtk_main_quit), NULL);
//  g_signal_connect (prevTb, "clicked", G_CALLBACK (prevPage), NULL);
//  g_signal_connect (nextTb, "clicked", G_CALLBACK (nextPage), NULL);

//  g_signal_connect(G_OBJECT(darea), "draw", G_CALLBACK(on_draw_event), NULL);

//  g_signal_connect(darea, "size-allocate", G_CALLBACK(dareaChanged), NULL);
//    g_signal_connect(G_OBJECT(window), "configure-event", G_CALLBACK(windowChanged), NULL);
//  g_signal_connect(G_OBJECT(window), "key_press_event", G_CALLBACK(onKeyPress), NULL);
  gtk_widget_show_all(GTK_WIDGET(box));
  gtk_window_present(window);
  zm_init(); // Initialize threads, and read settings data
}

void zm_process_moga_packet(unsigned char *p)
{
int i;
uint32_t ulNewButtons = 0;

//{
//	char szTemp[256];
//	sprintf(szTemp, "MOGA: %02x,%02x,%02x,%02x,%02x,%02x,%02x,%02x,%02x,%02x,%02x,%02x \n", p[0], p[1], p[2], p[3],p[4],p[5],p[6],p[7],p[8],p[9],p[10],p[11]);
//    OutputDebugString(szTemp);
//}
         iX = (signed char)p[6];
         iY = 0 - (signed char)p[7]; // sign is reversed
         iX2 = (signed char)p[8];
         iY2 = 0 - (signed char)p[9]; // sign is reversed
  		if (iX >= 64) // positive X  
		{
		    ulNewButtons |= RKEY_RIGHT_P1;
		}
		else if (iX <= -64) // negative X
		{
		    ulNewButtons |= RKEY_LEFT_P1;
		}
		if (iY >= 64) // positive Y
		{
		    ulNewButtons |= RKEY_DOWN_P1;
		}
		else if (iY <= -64) // negative Y
		{
		    ulNewButtons |= RKEY_UP_P1;
		}				
        if (iMouseMode != MOUSE_MODE_BOTH)
        {
  		    if (iX2 >= 64) // positive X  
		    {
		        ulNewButtons |= RKEY_RIGHT2_P1;
		    }
		    else if (iX2 <= -64) // negative X
		    {
		        ulNewButtons |= RKEY_LEFT2_P1;
		    }
		    if (iY2 >= 64) // positive Y
		    {
		        ulNewButtons |= RKEY_DOWN2_P1;
		    }
		    else if (iY2 <= -64) // negative Y
		    {
		        ulNewButtons |= RKEY_UP2_P1;
		    }
            if (b4Way)
            {
			    if (abs(iX2) > abs(iY2))
			    {		// x wins
				    ulNewButtons &= ~(RKEY_UP2_P1 | RKEY_DOWN2_P1);
			    }
			    else
			    {
				    ulNewButtons &= ~(RKEY_LEFT2_P1 | RKEY_RIGHT2_P1);							
			    }
            }
        }
		if (b4Way) // largest absolute value rules
		{
			if (abs(iX) > abs(iY))
			{		// x wins
				ulNewButtons &= ~(RKEY_UP_P1 | RKEY_DOWN_P1);
			}
			else
			{
				ulNewButtons &= ~(RKEY_LEFT_P1 | RKEY_RIGHT_P1);							
			}
		}
	        
         // button bits
		if (p[4] != 0)
		{
         for (i=0; i<8; i++)
            {
            if (p[4] & 1<<i)
               {
               ulNewButtons |= ulMOGAKeys[i];
               }
            }
		}
		 if ((iDeviceType == DEVICE_MOGAPRO || iDeviceType == DEVICE_MOGAPRO2) && p[5] != 0) // get the d-pad buttons and analog stick triggers (for now we ignore the lower 2 shoulder buttons)
		 {
         for (i=0; i<8; i++)
            {
            if (p[5] & 1<<i)
               {
               ulNewButtons |= ulMOGAKeys2[i];
               }
            }
		 }
         if (ulButtons != ulNewButtons)
            zm_process_buttons(ulNewButtons);
} /* zm_process_moga_packet() */

void zm_find_window(XEvent *event)
{
	XQueryPointer(dpy, root_window, &event->xbutton.root, &event->xbutton.window,
		&event->xbutton.x_root, &event->xbutton.y_root, &event->xbutton.x, &event->xbutton.y,
		&event->xbutton.state);
	event->xbutton.subwindow = event->xbutton.window;
	while (event->xbutton.subwindow)
	{
		event->xbutton.window = event->xbutton.subwindow;
		XQueryPointer(dpy, event->xbutton.window, &event->xbutton.root, &event->xbutton.subwindow,
		&event->xbutton.x_root, &event->xbutton.y_root, &event->xbutton.x, &event->xbutton.y,
		&event->xbutton.state);
	}
} /* zm_find_window() */

void zm_focus_window(int window)
{
XClientMessageEvent ev;
	memset(&ev, 0, sizeof(ev));
	ev.type = ClientMessage;
	ev.window = window;
	ev.message_type = XInternAtom(dpy, "_NET_ACTIVE_WINDOW", TRUE);
	ev.format = 32;
	ev.data.l[0] = 1;
	ev.data.l[1] = CurrentTime;
	ev.data.l[2] = ev.data.l[3] = ev.data.l[4] = 0;
	XSendEvent(dpy, RootWindow(dpy, XDefaultScreen(dpy)), FALSE,
		 SubstructureRedirectMask | SubstructureNotifyMask, (XEvent*)&ev);

} /* zm_focus_window() */

void zm_process_buttons(uint32_t ulNewButtons)
{
int i;
//uint32_t ulFlags;
XEvent event;
XKeyEvent keyevent;

//g_print("zm_process_buttons: %08x\n", ulNewButtons);

    if (iMouseMode == MOUSE_MODE_MOUSE || iMouseMode == MOUSE_MODE_BOTH)
    {
         if ((ulNewButtons & RKEY_BUTTA_P1) != (ulButtons & RKEY_BUTTA_P1)) // left mouse
         {
		memset(&event, 0, sizeof(event));
		event.xbutton.button = Button1;
		event.xbutton.same_screen = TRUE;
		zm_find_window(&event);
            if (ulNewButtons & RKEY_BUTTA_P1)
		{
			event.type = ButtonPress;
			zm_focus_window(event.xbutton.window);
		}
            else
		{
			event.xbutton.state = Button1Mask;
			event.type = ButtonRelease;
		}
		event.xbutton.time = CurrentTime;
		pthread_mutex_lock(&mutex);
		XSendEvent(dpy, PointerWindow /*event.xbutton.window*/, TRUE, 0xfff, &event);
		XFlush(dpy);
		pthread_mutex_unlock(&mutex);
         }
         if ((ulNewButtons & RKEY_BUTTB_P1) != (ulButtons & RKEY_BUTTB_P1)) // right mouse
         {
		memset(&event, 0, sizeof(event));
		event.xbutton.button = Button3;
		event.xbutton.same_screen = TRUE;
		zm_find_window(&event);
            if (ulNewButtons & RKEY_BUTTB_P1)
		{
			event.type = ButtonPress;
		}
            else
		{
			event.xbutton.state = Button3Mask;
			event.type = ButtonRelease;
		}
		event.xbutton.time = CurrentTime;
		pthread_mutex_lock(&mutex);
		XSendEvent(dpy, event.xbutton.window, TRUE, 0xfff, &event);
		XFlush(dpy);
		pthread_mutex_unlock(&mutex);
         }
    } // mouse mode
    if (iMouseMode == MOUSE_MODE_JOYSTICK || iMouseMode == MOUSE_MODE_BOTH)
    {
       for (i=0; i<20; i++)
       {
          if ((ulNewButtons & (1<<i)) != (ulButtons & (1<<i))) // did a button get pressed or released?
          {
		int iRevert;
		Window win;
		memset(&keyevent, 0, sizeof(keyevent));
		keyevent.display = dpy;
		keyevent.keycode = XKeysymToKeycode(dpy, uiDefaultJoyKeys[i]);
		keyevent.subwindow = None;
		XGetInputFocus(dpy, &win, &iRevert);
		keyevent.window = win;
		keyevent.same_screen = TRUE;
		keyevent.time = CurrentTime;
		keyevent.x = 1;
		keyevent.y = 1;
		keyevent.x_root = 1;
		keyevent.y_root = 1;
		keyevent.root = RootWindow(dpy, XDefaultScreen(dpy));
             if (ulNewButtons & (1<<i)) // pressed
                {
	                keyevent.type = KeyPress;
			
//                if (hKeyDef != 0) // keydef dialog is displayed, select the input field for this key
//                   {
//                      PostMessage(hKeyDef, WM_COMMAND, IDC_BUTTON2, i);
//                   }
                }
             else
		{
	                keyevent.type = KeyRelease;
		}
             if (iMouseMode == MOUSE_MODE_BOTH && ((1<<i) == RKEY_BUTTA_P1 || (1<<i) == RKEY_BUTTB_P1))
		{
                	continue; // don't generate key presses for mouse buttons in mode 2
		}
		pthread_mutex_lock(&mutex);
		XSendEvent(dpy, keyevent.window, TRUE, KeyPressMask, (XEvent *)&keyevent);
		XFlush(dpy);
		pthread_mutex_unlock(&mutex);
          }
       }
    } // keyboard/gamepad mode
    ulButtons = ulNewButtons;

} /* zm_process_buttons() */

// 
// Each of the following 'zm_process_xxx_packet()' functions takes a byte
// buffer of data received and updates the button and stick position variables
//
void zm_process_zeemote_packet(unsigned char *p)
{
int i;
uint32_t ulNewButtons = ulButtons; // only receives reports of changed buttons
//unsigned char szTemp[256];
//BOOL bDPad = FALSE;

//	g_print("zm_process_zeemote_packet 0=%02x, 1=%02x, 2=%02x, 3=%02x\n", p[0], p[1], p[2], p[3]);

   switch (p[2]) // switch on packet type
      {
      case 3: // unknown
      case 4:
      case 5:
         break;

      default: // some data packet we haven't seen before
         break;
         
      case 0x7: // buttons
		  for (i = 0; i < 4; i++) // clear bits specified in this report
		  {
			  if (iDeviceType == DEVICE_ZEEMOTE)
				  ulNewButtons &= ~ulZKeys[i];
			  else
				  ulNewButtons &= ~ulSteelButtons[i];
		  }
         for (i=0; i<4; i++)
            {
            if (p[3+i] != 0xfe)
               {
               if (iDeviceType == DEVICE_ZEEMOTE)
                  ulNewButtons |= ulZKeys[p[3+i]];
               else
                  ulNewButtons |= ulSteelButtons[p[3+i]];
               }
            }
         break;
       case 0x1c:  // d-pad and new buttons (Steelseries Free)
		   for (i = 0; i < 8; i++)
		   {
			   ulNewButtons &= ~ulSteelButtons2[i];
		   }
		  for (i = 0; i<8; i++) // report always tells state of dpad and 4 buttons
	      {
             if (p[3+i] >= 4 && p[3+i] <= 11) // valid values
             {
//                if (p[3] < 8) // dpad is active
//                {
//                   bDPad = true;
//	            }				
                ulNewButtons |= ulSteelButtons2[p[3+i]-4];
//				if (!bDPad && bDPadDown == true) // DPad was in use, but now is released; reset bits
//				{
//					iKeys[iPlayer] &= ~(RKEY_UP_P1 | RKEY_DOWN_P1 | RKEY_LEFT_P1 | RKEY_RIGHT_P1);
//				}
//				bDPadDown = bDPad;
			}
         } // for i
         break;

      case 0x8: // analog stick(s)
        if (p[3] == 0) // stick 0
           {
			ulNewButtons &= ~(RKEY_RIGHT_P1 | RKEY_LEFT_P1 | RKEY_UP_P1 | RKEY_DOWN_P1);
            iX = (signed char)p[4];
            iY = (signed char)p[5];
  		    if (iX >= 32) // positive X  
		    {
		        ulNewButtons |= RKEY_RIGHT_P1;
		    }
		    else if (iX <= -32) // negative X
		    {
		        ulNewButtons |= RKEY_LEFT_P1;
		    }
		    if (iY >= 32) // positive Y
		    {
		        ulNewButtons |= RKEY_DOWN_P1;
		    }
		    else if (iY <= -32) // negative Y
		    {
		        ulNewButtons |= RKEY_UP_P1;
		    }				
		    if (b4Way) // largest absolute value rules
		    {
			    if (abs(iX) > abs(iY))
			    {
			    // x wins
				    ulNewButtons &= ~(RKEY_UP_P1 | RKEY_DOWN_P1);
			    }
			    else
			    {
				    ulNewButtons &= ~(RKEY_LEFT_P1 | RKEY_RIGHT_P1);							
			    }
		    }
         }
         else // stick 1
         {
			 ulNewButtons &= ~(RKEY_RIGHT2_P1 | RKEY_LEFT2_P1 | RKEY_UP2_P1 | RKEY_DOWN2_P1);
			 iX2 = (signed char) p[4];
            iY2 = (signed char)p[5];
            if (iMouseMode != MOUSE_MODE_BOTH)
            {
  		        if (iX2 >= 32) // positive X  
		        {
		            ulNewButtons |= RKEY_RIGHT2_P1;
		        }
		        else if (iX2 <= -32) // negative X
		        {
		            ulNewButtons |= RKEY_LEFT2_P1;
		        }
		        if (iY2 >= 32) // positive Y
		        {
		            ulNewButtons |= RKEY_DOWN2_P1;
		        }
		        else if (iY2 <= -32) // negative Y
		        {
		            ulNewButtons |= RKEY_UP2_P1;
		        }				
		        if (b4Way) // largest absolute value rules
		        {
			        if (abs(iX2) > abs(iY2))
			        {
			        // x wins
				        ulNewButtons &= ~(RKEY_UP2_P1 | RKEY_DOWN2_P1);
			        }
			        else
			        {
				        ulNewButtons &= ~(RKEY_LEFT2_P1 | RKEY_RIGHT2_P1);							
			        }
		        }
            }
         }
        break;
      case 0x11: // battery status
         iBattery = (p[3]<<8) + p[4]; // millivolts
// FUTURE - display the battery level of the ZeeMote
//         sprintf((LPSTR)szTemp, "%d.%03dV", iBattery/1000, iBattery%1000);
         break;
      } // switch
      if (ulButtons != ulNewButtons)
         zm_process_buttons(ulNewButtons);
} /* zm_process_zeemote_packet() */

void zm_process_icontrolpad_packet(unsigned char *pData)
{
uint32_t ulNewButtons = 0;
signed char *pNubs = (signed char *)pData;
int i;

    iX = pNubs[0];
    iY = pNubs[1];
    iX2 = pNubs[2];
    iY2 = pNubs[3];
// All button/analog stick data is sent in every report
    // left analog nub
	if (iX > 64) // positive X
	{
		ulNewButtons |= RKEY_RIGHT_P1;
	}
	else if (iX < -32) // negative X
	{
		ulNewButtons |= RKEY_LEFT_P1;
	}
	if (iY > 64) // positive Y
	{
		ulNewButtons |= RKEY_DOWN_P1;
	}
	else if (iY < -64) // negative Y
	{
		ulNewButtons |= RKEY_UP_P1;
	}
	if (b4Way) // largest absolute value rules
	{
		if (abs(iX) > abs(iY))
		{
		// x wins
			ulNewButtons &= ~(RKEY_UP_P1 | RKEY_DOWN_P1);
		}
		else
		{
			ulNewButtons &= ~(RKEY_LEFT_P1 | RKEY_RIGHT_P1);							
		}
	}
	// right analog nub
    if (iMouseMode != MOUSE_MODE_BOTH)
    {
	    if (iX2 > 64) // positive X
	    {
		    ulNewButtons |= RKEY_RIGHT2_P1;
	    }
	    else if (iX2 < -32) // negative X
	    {
		    ulNewButtons |= RKEY_LEFT2_P1;
	    }
	    if (iY2 > 64) // positive Y
	    {
		    ulNewButtons |= RKEY_DOWN2_P1;
	    }
	    else if (iY2 < -64) // negative Y
	    {
		    ulNewButtons |= RKEY_UP2_P1;
	    }
	    if (b4Way) // largest absolute value rules
	    {
		    if (abs(iX2) > abs(iY2))
		    {
		    // x wins
			    ulNewButtons &= ~(RKEY_UP2_P1 | RKEY_DOWN2_P1);
		    }
		    else
		    {
			    ulNewButtons &= ~(RKEY_LEFT2_P1 | RKEY_RIGHT2_P1);							
		    }
	    }
    }
	// byte "A"
	for (i=0; i<5; i++)
	    {
			if ((pData[4] & (1<<i)) != 0) // bit set indicates button pressed
	        {
				ulNewButtons |= ulICPKeys[i];
	        }
	    }
	// byte "B"
	for (i=0; i<7; i++)
	    {
			if ((pData[5] & (1<<i)) != 0) // bit set indicates button pressed
	        {
				ulNewButtons |= ulICPKeys[i+5];
	        }
	    }			
      if (ulButtons != ulNewButtons)
         zm_process_buttons(ulNewButtons);
} /* zm_process_icontrolpad_packet() */

void zm_process_bgp100_packet(unsigned char *p, int iPlayer)
{
unsigned char c;
uint32_t ulNewButtons;
uint32_t ulBGP100Keys[16] = {0,0,0,0, // 0-3
                                  RKEY_START_P1, RKEY_BUTTB_P1, RKEY_BUTTA_P1, RKEY_BUTTC_P1, // 4-7
                                  RKEY_SELECT_P1,RKEY_BUTTE_P1,RKEY_UP_P1,RKEY_LEFT_P1, // 8-B
                                  RKEY_RIGHT_P1, RKEY_DOWN_P1, RKEY_BUTTD_P1, 0}; // C-F

   if (iPlayer == 1)
      ulNewButtons = ulButtons >> 16;
   else
      ulNewButtons = ulButtons;
   if ((p[0] + p[1]) == 0xff) // valid command
      {
      c = p[0] & 0xf; // get key code (lower 4 bits)
      if (p[0] & 0x40) // key release
         {
         ulNewButtons &= ~ulBGP100Keys[c];
         }
      else               // key press
         {
         ulNewButtons |= ulBGP100Keys[c];
         }
      }
   else
      return; // invalid packet

    // simulate mouse movement
        iX = iY = 0;
        if (ulNewButtons & RKEY_LEFT_P1)
        iX = -24;
        else if (ulNewButtons & RKEY_RIGHT_P1)
        iX = 24;
        if (ulNewButtons & RKEY_UP_P1)
        iY = -24;
        else if (ulNewButtons & RKEY_DOWN_P1)
        iY = 24;
      if (ulButtons != ulNewButtons)
      {
         zm_process_buttons(ulNewButtons);
      }

} /* zm_process_bgp100_packet() */

void zm_send_command(int s, unsigned char command)
{
unsigned char Bytes[5];
unsigned char security = 0;
int i;

    Bytes[0] = 90;
    Bytes[1] = 5; // packet length
    Bytes[2] = command;
    Bytes[3] = 1;
    for (i=0; i<4; i++)
    	security ^= Bytes[i]; 
    Bytes[4] = security;
    send(s, (const char *)&Bytes[0], 5, 0);
} /* zm_send_command() */

void zm_bt_disconnect(void)
{
    bConnected = FALSE;
    close(theSocket);
    theSocket = 0;
    zm_process_buttons(0); // make sure no keys/mouse buttons are left pressed
    g_print("disconnected\n");
} /* zm_bt_disconnect() */

// Move the cursor in a reasonble manner with another background thread
void zm_cursor_thread(void *pThreadInfo)
{
Window window_returned;
int root_x, root_y, win_x, win_y;
unsigned int mask_return;
int iFrame, iFrameMask;
XEvent event;

	dpy = XOpenDisplay(0);
	if (dpy == NULL)
	{
		g_print("Can't open display for cursor movement\n");
		return;
	}
	root_window = XRootWindow(dpy, 0);
	XSelectInput(dpy, root_window, KeyReleaseMask);
	iFrame = 0;
	while (bRunning)
	{
		iFrame++; // for timing scroll wheel events
		// If connected and in mouse mode, look at the current direction bits to move the cursor
		if (bConnected && (iMouseMode == MOUSE_MODE_MOUSE || iMouseMode == MOUSE_MODE_BOTH))
		{
			if (iY2 < -32 || iY2 > 32) // simulate scroll wheel
			{
				memset(&event, 0, sizeof(event));
				if (iY2 < 0)
					event.xbutton.button = Button4;
				else
					event.xbutton.button = Button5;
				// button press/release frequence determines scroll speed
				// use our iFrame as a timer
				if (abs(iY2) > 100) // fastest
					iFrameMask = 3;
				else if (abs(iY2) > 64)
					iFrameMask = 7;
				else iFrameMask = 15;
				if ((iFrame & iFrameMask) == 0) // create the scroll event
				{
					event.xbutton.same_screen = TRUE;
					zm_find_window(&event);
					event.xbutton.time = CurrentTime;
					event.type = ButtonPress;
					// X11 only allows 1 thread at a time
					pthread_mutex_lock(&mutex);
					XSendEvent(dpy, event.xbutton.window, TRUE, 0xfff, &event);
					event.type = ButtonRelease;
//				event.xbutton.state = Button3Mask;
					XSendEvent(dpy, event.xbutton.window, TRUE, 0xfff, &event);
					XFlush(dpy);
					pthread_mutex_unlock(&mutex);
				}
			}
			if (ulButtons & (RKEY_LEFT_P1 | RKEY_RIGHT_P1 | RKEY_UP_P1 | RKEY_DOWN_P1)) // direction held
			{
				if (!XQueryPointer(dpy, root_window, &window_returned, &window_returned,
					&root_x, &root_y, &win_x, &win_y, &mask_return))
				{
					g_print("XQueryPointer failed\n");
				}
				iCursorX = root_x;
				iCursorY = root_y;
				if (iX < -32 || iX > 32) // analog stick
				{
					iCursorX += (iX>>4);
				}
				if (iY < -32 || iY > 32)
				{
					iCursorY += (iY>>4);
				}
				if (iCursorX == root_x && iCursorY == root_y) // if no activity on analog sticks, try digital 8-way
				{
					if (ulButtons & RKEY_LEFT_P1 && iCursorX >= iCursorSpeed) iCursorX-=iCursorSpeed;
					if (ulButtons & RKEY_UP_P1 && iCursorY >= iCursorSpeed) iCursorY-=iCursorSpeed;
					if (ulButtons & RKEY_RIGHT_P1) iCursorX+=iCursorSpeed;
					if (ulButtons & RKEY_DOWN_P1) iCursorY+=iCursorSpeed;
				}
				if (iCursorX != root_x || iCursorY != root_y)
				{
//					g_print("About to move cursor to %d, %d\n", iCursorX, iCursorY);
					XWarpPointer(dpy, None, root_window, 0, 0, 0, 0, iCursorX, iCursorY);
					XFlush(dpy);
				}
			}
		}
		usleep(16000); // sleep 16ms waiting for new actions
	}
	XCloseDisplay(dpy);
} /* zm_cursor_thread() */

// process bluetooth data in the background
void zm_background_thread(void *pThreadInfo)
{
int i, j, iOffset;
unsigned char szBuf[BUFFER_SIZE];
static int iTotal = 0;

	i = iOffset = 0;

background_top:
	while (bRunning)
	{
		if (bConnected)
		{
			if (i < 0 || iOffset < 0) // something went wrong, reset
			{
				i = iOffset = 0;
			}
//			if (i != 0 && iOffset != 0 && iOffset > 0 && (iOffset + i) < BUFFER_SIZE) // some leftover data
//			{
//				memcpy(szBuf, &szBuf[iOffset], i); // move the remaining bytes to offset 0
//			}
			iOffset = 0; // read the bytes starting from offset 0
//			j = read(theSocket, (char *)&szBuf[i], BUFFER_SIZE-i);
			j = recv(theSocket, (char *)&szBuf[i], BUFFER_SIZE-i, 0);
			iTotal += j;
//			g_print("received %d bytes, total=%d, i=%d, iOffset=%d\n", j, iTotal, i, iOffset);
			if (j == 0) // sleep a little to wait for more data
			{
				usleep(5000); // 5ms is enough
				continue;
			}
//			if (j == -1) // we got disconnected
//			{
//				zm_bt_disconnect();
//				i = iOffset = 0;
//				continue;
//			}
                        if (j > 0)
                        {
			   i += j; // add new data to the old
                        }
			switch (iDeviceType)
			{
			case DEVICE_ZEEMOTE:
			case DEVICE_STEELSERIES:
			while (i > 0)
			{
			if (szBuf[iOffset+1] == 0xa1) // magic byte
                           {
			   if (i < (szBuf[iOffset]+1)) // incomplete packet, read more
                           {
				g_print("incomplete packet: iOffset=%d, i=%d, szBuf[iOffset]=%d\n", iOffset, i, szBuf[iOffset]);
				goto background_top;
                           }
                           zm_process_zeemote_packet(&szBuf[iOffset]);
                           i -= szBuf[iOffset]+1; // skip to next packet
                           iOffset += szBuf[iOffset]+1;
                           }
                        else // we got some garbage, look for A1
                           {
                           while (i>1 && szBuf[iOffset+1] != 0xa1)
                              {
				g_print("scanning ahead for A1\n");
                              iOffset++;
                              i--;
                              }
                           }
                        } // while data available
                   break;
                case DEVICE_ICONTROLPAD:
                     while (i >= 6) // enough to process at least one packet
                     {
                        zm_process_icontrolpad_packet(&szBuf[iOffset]);
                        i -= 6; // skip to next packet
                        iOffset += 6;
                     } // while data available
                    break;
                case DEVICE_BGP100:
                     while (i >= 2) // enough to process at least one packet
                     {
                        if ((szBuf[iOffset] + szBuf[iOffset+1]) == 0xff) // valid packet?
                        {
                           zm_process_bgp100_packet(&szBuf[iOffset], 0);
                           i -= 2; // skip to next packet
                           iOffset += 2;
                        }
                        else
                        {
                            i--; // re-align and try again
                            iOffset++;
                        }
                     } // while data available
                   break;
                case DEVICE_MOGA:
				case DEVICE_MOGA2:
				case DEVICE_MOGAPRO:
				case DEVICE_MOGAPRO2:
                     while (i >= 12) // 12 byte packets
                     {
                     zm_process_moga_packet(&szBuf[iOffset]);
                     i -= 12;
                     iOffset += 12;
                     }
		            // Need to send a reset/flush after each group of packets is received
    	            zm_send_command(theSocket, CMD_RESET);
		    zm_send_command(theSocket, CMD_FLUSH);
                   break;
             } // switch on device type
		} // if connected
		else // don't eat up CPU time
		{
			i = iOffset = 0; // no data
			usleep(250000); // sleep for 1/4 second
		}
	} // while (bRunning)
} /* zm_background_thread() */

void zm_load_settings()
{
  int i;
  char szTemp[256];

  iDeviceCount = g_settings_get_int(mySettings, "devicecount");
//  g_print("iDeviceCount=%d\n", iDeviceCount);
  if (iDeviceCount > MAX_DEVICES) iDeviceCount = MAX_DEVICES; // fix it
  for (i=0; i<iDeviceCount; i++) // read the saved device names
  {
     sprintf(szTemp, "devicename%d", i);
     szDeviceName[i] = g_settings_get_string(mySettings, szTemp);
     sprintf(szTemp, "deviceaddr%d", i);
     szDeviceAddr[i] = g_settings_get_string(mySettings, szTemp);
     sprintf(szTemp, "devicemode%d", i);
     iDeviceMode[i] = g_settings_get_int(mySettings, szTemp);
//	g_print("device %d -> %s / %s\n", i, szDeviceName[i], szDeviceAddr[i]);
  }
} /* zm_load_settings() */

void zm_init(void)
{
  ii = (inquiry_info *)malloc(MAX_RSP * sizeof(inquiry_info));
  // create a mutex to keep mouse/key events from colliding in X11
  pthread_mutex_init(&mutex, NULL);
  // start the background thread for communication
  pthread_create(&tinfo, NULL, (void *)zm_background_thread, NULL);
  // start another background thread to move the mouse cursor
  pthread_create(&tinfo, NULL, (void *)zm_cursor_thread, NULL);
  // GTK Settings
  mySettings = g_settings_new("com.tdfsoftware.zeemouse");
  zm_load_settings();
  zm_update_list(); // show the list of existing paired controllers
  iDevice = 0; // select first device in the list
}

int zm_find_device_type(char *name)
{
int i, iLen;

	i = 0;
        while (szDeviceNames[i] != NULL)
        {
	   iLen = strlen(szDeviceNames[i]);

           if (memcmp(name, szDeviceNames[i], iLen) == 0)
           {
              // found!
		g_print("found device type %d for %s\n", i, name);
		return i;
           }
           i++;
        }
	g_print("Didn't find device type for %s\n", name);
	return -1; // not found
} /* zm_find_device_type() */

// show the paired devices in the list
void zm_update_list()
{
int i;
GtkTreeIter iter2;

	gtk_list_store_clear(store); // remove all previous items from the list

	for (i=0; i<iDeviceCount; i++)
	{
		gtk_list_store_insert_with_values(store, &iter, -1, 0,szDeviceName[i],1,szDeviceAddr[i],2,szModeNames[iDeviceMode[i]], 3, "",4,"written by Larry Bank",-1);
		if (i == iDevice) iter2 = iter; // keep current device selected
	}
// Re-select the current device
	gtk_tree_selection_select_iter(selection, &iter2);

} /* zm_update_list() */

void zm_add_device(char *name, char *addr)
{
int i;
	for (i=0; i<iDeviceCount; i++) // see if it already exists
	{
		if (strcmp(addr, szDeviceAddr[i]) == 0)
			break; // device already exists
	}
	if (iDeviceCount == 0 || i == iDeviceCount) // new device
	{
		char szKey[64];
		g_print("adding new device: %s\n", name);
		sprintf(szKey,"devicename%d", i);
		g_settings_set_string(mySettings, szKey, name);
		szDeviceName[i] = g_settings_get_string(mySettings, szKey);
		sprintf(szKey,"deviceaddr%d", i);
		g_settings_set_string(mySettings, szKey, addr);
		szDeviceAddr[i] = g_settings_get_string(mySettings, szKey);
		iDeviceMode[i] = MOUSE_MODE_MOUSE; // default mode
		sprintf(szKey,"devicemode%d", i);
		g_settings_set_int(mySettings, szKey, MOUSE_MODE_MOUSE);
		iDeviceCount++;
		g_settings_set_int(mySettings, "devicecount", iDeviceCount);
		zm_update_list();
	}
	else
	{
		g_print("not adding device: %s\n", name);
	}
} /* zm_add_device() */
 
int zm_bt_discovery(void)
{
  int num_rsp;
  int dev_id, sock, len, flags;
  int i, ret;
  char addr[19] = {0};
  char name[248] = {0};

  sock = -1;
  ret = 0; // assume not found

  g_print("About to scan bluetooth devices\n");
  dev_id = hci_get_route(NULL);
  sock = hci_open_dev( dev_id );
  if (dev_id < 0 || sock < 0)
  {
     g_print("error opening socket\n");
     goto discoveryz;
  }
  len = 8; // each time is 1.26 seconds, so 10 seconds is a good amount
  flags = IREQ_CACHE_FLUSH;

  num_rsp = hci_inquiry(dev_id, len, MAX_RSP, NULL, &ii, flags);
  if ( num_rsp < 0 ) 
  {
     g_print("error - hci inquiry\n");
     goto discoveryz;
  }
  for (i=0; i<num_rsp; i++)
  {
     ba2str(&(ii+i)->bdaddr, addr);
     memset(name, 0, sizeof(name));
     if (hci_read_remote_name(sock, &(ii+i)->bdaddr, sizeof(name), name, 0) < 0)
     {
       strcpy(name, "unknown");
     }
     else
     {
        g_print("Found - %s   %s\n", addr, name);
        iDeviceType = zm_find_device_type(name);
	if (iDeviceType != -1) // found it
	{
		// add it to the list
		zm_add_device(name, addr); // if it's not in the list, add it
              // use this addr
              memcpy(&rem_addr.rc_bdaddr, &(ii+i)->bdaddr, sizeof(struct sockaddr_rc));
              ret = 1;
              goto discoveryz;
        }
     }
  }

  discoveryz:
  g_print("finished scanning for devices\n");
  if (sock != -1)
  {
     close ( sock );
  }
  return ret;

} /* zm_bt_discovery() */

int zm_bt_connect(void)
{
  int i, ret;
  int lm = 0;

  ret = 0;
  iDeviceType = zm_find_device_type(szDeviceName[iDevice]);
  str2ba(szDeviceAddr[iDevice], &rem_addr.rc_bdaddr);
  // Negotiate SDP before RFCOMM
  //sdpSocket = socket(AF_BLUETOOTH, SOCK_STREAM );


  theSocket = socket(AF_BLUETOOTH, SOCK_STREAM, BTPROTO_RFCOMM);
  lm |= RFCOMM_LM_TRUSTED;
//  i = setsockopt(theSocket, SOL_RFCOMM, RFCOMM_LM, &lm, sizeof(lm));
//  g_print("setsockopt returned %d\n", i);
  // bind socket to port 1 of the first available local bluetooth adapter
  rem_addr.rc_family = AF_BLUETOOTH;
  rem_addr.rc_channel = 1;
  g_print("connecting to %s / %s\n", szDeviceName[iDevice], szDeviceAddr[iDevice]);
  i = connect(theSocket, (struct sockaddr *)&rem_addr, sizeof(rem_addr));
  // Also connect to HID-Control

  if (i == 0)
  {
     struct timeval tv;

     ret = 1;
     tv.tv_sec = 2;
     setsockopt(theSocket, SOL_SOCKET, SO_RCVTIMEO,(struct timeval *)&tv,sizeof(struct timeval));
     setsockopt(theSocket, SOL_SOCKET, SO_SNDTIMEO,(struct timeval *)&tv,sizeof(struct timeval));
     
     g_print("Connected to %s\n", szDeviceNames[iDeviceType]);
       if (iDeviceType == DEVICE_MOGA || iDeviceType == DEVICE_MOGAPRO || iDeviceType == DEVICE_MOGA2 || iDeviceType == DEVICE_MOGAPRO2)
       {
          g_print("Sending special commands to initialize the MOGA\n");
          zm_send_command(theSocket, CMD_INIT);
          zm_send_command(theSocket, CMD_RESET);
       }
       if (iDeviceType == DEVICE_ICONTROLPAD)
       {
			unsigned char Bytes[2];
			Bytes[0] = 0xad;
			Bytes[1] = 0x01; // set autonomous mode on
			send(theSocket, (const char *)&Bytes[0], 2, 0); 
			i = recv(theSocket, (char *)Bytes, 1, 0); // read the response
			if (i != 1 || Bytes[0] != 0x80) // something went wrong
				g_print("Failed to initialize the iControlPad\n");
       }
	   if (iDeviceType == DEVICE_STRATUS)
       {
		   g_print("Sending handshake to Stratus\n");
			unsigned char Bytes[100];
			i = recv(theSocket, (char *)Bytes, 6, 0); // Read
			if (i < 4) // something went wrong
				g_print("Failed to initialize the Stratus\n");
			// Send initialization
			Bytes[0] = 0xff; // set autonomous mode on
			Bytes[1] = 0x55;
			Bytes[2] = 0x02; // set autonomous mode on
			Bytes[3] = 0x00;
			Bytes[4] = 0xee; // set autonomous mode on
			Bytes[5] = 0x10;
			send(theSocket, (const char *)&Bytes[0], 6, 0);

			i = recv(theSocket, (char *)Bytes, 14, 0); // Read
			i = recv(theSocket, (char *)Bytes, 16, 0); // Read
			if (i < 4) // something went wrong
				g_print("Failed to initialize the Stratus\n");
			// Should respond with ff 5a 00 1a 80 40 00 00 cd
			// Should respond with 7-16 bits??? 01 05 08 00 05 dc 00 48 1e 03 0a 00 01 0b 02 01 8f

			g_print("Sending agreement to Stratus\n");
			// Send ??? (25 bytes)
			// ff 5a 00 1a c0 ?? 40 00 ?? 01 7f ff ff 05 dc 00 48 1e 03 0a 00 01 0b 02 01 1f
			// left 2d 60
			// right 4b 42
			Bytes[0] = 0xff;
			Bytes[1] = 0x5a;
			Bytes[2] = 0x00;
			Bytes[3] = 0x1a;
			Bytes[4] = 0xc0;
			Bytes[5] = 0x4b; // ??
			Bytes[6] = 0x40;
			Bytes[7] = 0x00;
			Bytes[8] = 0x42; // ??
			Bytes[9] = 0x01;
			Bytes[10] = 0x7f;
			Bytes[11] = 0xff;
			Bytes[12] = 0xff;
			Bytes[13] = 0x05;
			Bytes[14] = 0xdc;
			Bytes[15] = 0x00;
			Bytes[16] = 0x48;
			Bytes[17] = 0x1e;
			Bytes[18] = 0x03;
			Bytes[19] = 0x0a;
			Bytes[20] = 0x00;
			Bytes[21] = 0x01;
			Bytes[22] = 0x0b;
			Bytes[23] = 0x02;
			Bytes[24] = 0x01;
			Bytes[25] = 0x1f;
			int loop = 0;
			int loop2 = 0;
			Bytes[5] = 0;
			Bytes[8] = 0;
			for(loop = 0; loop<255; loop++) {
				for(loop2 = 0; loop2<255; loop2++) {
					send(theSocket, (const char *)&Bytes[0], 26, 0);
					Bytes[8]++;
					//sleep(0.1);
					//g_print("Spamming\n");
					//send(theSocket, (const char *)&STRATUS_HANDSHAKE, 26, 0);
				}
				send(theSocket, (const char *)&Bytes[0], 26, 0);
				Bytes[5]++;

			}
			g_print("Spam Complete\n");
			

			// Respond with ff 5a 00 09 40 41 ?? ??
			// left 2d 00 f0
			// right 4b 00 d2
			i = recv(theSocket, (char *)Bytes, 16, 0); // Read
			i = recv(theSocket, (char *)Bytes, 16, 0); // Read

			g_print("Requesting data from Stratus\n");
			// Send ff 5a 00 10 40 4c 40 0a c1 40 40 00 06 aa 00 d0
			Bytes[0] = 0xff;
			Bytes[1] = 0x5a;
			Bytes[2] = 0x00;
			Bytes[3] = 0x10;
			Bytes[4] = 0x40;
			Bytes[5] = 0x4c; // Add 1
			Bytes[6] = 0x40;
			Bytes[7] = 0x0a;
			Bytes[8] = 0xc2; // df, c1 Add 7F from byte 8
			Bytes[9] = 0x40;
			Bytes[10] = 0x40;
			Bytes[11] = 0x00;
			Bytes[12] = 0x06;
			Bytes[13] = 0xaa;
			Bytes[14] = 0x00;
			Bytes[15] = 0xd0;
			//send(theSocket, (const char *)&Bytes[0], 16, 0);
       }
  }
  else
  {
     g_print("connection failed, ret = %d\n", i);
     zm_bt_close();
  }
  return ret;
} /* zm_bt_connect() */

void zm_bt_close(void)
{
   if (theSocket != -1)
   {
      close(theSocket);
      theSocket = -1;
   }
} /* zm_bt_close() */

void zm_terminate(void)
{
  if (bConnected)
  {
     zm_bt_disconnect();
  }
  if (ii != NULL)
  {
     free(ii);
  }
  bRunning = FALSE; // let the background thread exit
} /* zm_terminate() */

int main (int argc, char **argv)
{
  GtkApplication *app;

  app = gtk_application_new ("com.tdfsoftware.zeemouse", G_APPLICATION_HANDLES_OPEN/*G_APPLICATION_FLAGS_NONE*/);
  g_signal_connect (app, "activate", G_CALLBACK (activate), NULL);
  g_application_run (G_APPLICATION (app), argc, argv);
  g_object_unref (app);
  zm_terminate();
  return 0;
} // main()
